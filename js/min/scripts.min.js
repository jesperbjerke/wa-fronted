window.Modernizr=function(t,e,a){function n(t){w.cssText=t}function o(t,e){return n(y.join(t+";")+(e||""))}function i(t,e){return typeof t===e}function r(t,e){return!!~(""+t).indexOf(e)}function s(t,e){for(var n in t){var o=t[n];if(!r(o,"-")&&w[o]!==a)return"pfx"==e?o:!0}return!1}function c(t,e,n){for(var o in t){var r=e[t[o]];if(r!==a)return n===!1?t[o]:i(r,"function")?r.bind(n||e):r}return!1}function l(t,e,a){var n=t.charAt(0).toUpperCase()+t.slice(1),o=(t+" "+k.join(n+" ")+n).split(" ");return i(e,"string")||i(e,"undefined")?s(o,e):(o=(t+" "+x.join(n+" ")+n).split(" "),c(o,e,a))}var f,d,u,p="2.8.3",_={},m=!0,g=e.documentElement,h="modernizr",v=e.createElement(h),w=v.style,y=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),b="Webkit Moz O ms",k=b.split(" "),x=b.toLowerCase().split(" "),j={},C=[],E=C.slice,z=function(t,a,n,o){var i,r,s,c,l=e.createElement("div"),f=e.body,d=f||e.createElement("body");if(parseInt(n,10))for(;n--;)s=e.createElement("div"),s.id=o?o[n]:h+(n+1),l.appendChild(s);return i=["&#173;",'<style id="s',h,'">',t,"</style>"].join(""),l.id=h,(f?l:d).innerHTML+=i,d.appendChild(l),f||(d.style.background="",d.style.overflow="hidden",c=g.style.overflow,g.style.overflow="hidden",g.appendChild(d)),r=a(l,t),f?l.parentNode.removeChild(l):(d.parentNode.removeChild(d),g.style.overflow=c),!!r},I={}.hasOwnProperty;u=i(I,"undefined")||i(I.call,"undefined")?function(t,e){return e in t&&i(t.constructor.prototype[e],"undefined")}:function(t,e){return I.call(t,e)},Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;if("function"!=typeof e)throw new TypeError;var a=E.call(arguments,1),n=function(){if(this instanceof n){var o=function(){};o.prototype=e.prototype;var i=new o,r=e.apply(i,a.concat(E.call(arguments)));return Object(r)===r?r:i}return e.apply(t,a.concat(E.call(arguments)))};return n}),j.opacity=function(){return o("opacity:.55"),/^0.55$/.test(w.opacity)},j.cssanimations=function(){return l("animationName")},j.csstransforms=function(){return!!l("transform")},j.csstransforms3d=function(){var t=!!l("perspective");return t&&"webkitPerspective"in g.style&&z("@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}",function(e,a){t=9===e.offsetLeft&&3===e.offsetHeight}),t},j.csstransitions=function(){return l("transition")};for(var P in j)u(j,P)&&(d=P.toLowerCase(),_[d]=j[P](),C.push((_[d]?"":"no-")+d));return _.addTest=function(t,e){if("object"==typeof t)for(var n in t)u(t,n)&&_.addTest(n,t[n]);else{if(t=t.toLowerCase(),_[t]!==a)return _;e="function"==typeof e?e():e,"undefined"!=typeof m&&m&&(g.className+=" "+(e?"":"no-")+t),_[t]=e}return _},n(""),v=f=null,function(t,e){function a(t,e){var a=t.createElement("p"),n=t.getElementsByTagName("head")[0]||t.documentElement;return a.innerHTML="x<style>"+e+"</style>",n.insertBefore(a.lastChild,n.firstChild)}function n(){var t=v.elements;return"string"==typeof t?t.split(" "):t}function o(t){var e=h[t[m]];return e||(e={},g++,t[m]=g,h[g]=e),e}function i(t,a,n){if(a||(a=e),f)return a.createElement(t);n||(n=o(a));var i;return i=n.cache[t]?n.cache[t].cloneNode():_.test(t)?(n.cache[t]=n.createElem(t)).cloneNode():n.createElem(t),!i.canHaveChildren||p.test(t)||i.tagUrn?i:n.frag.appendChild(i)}function r(t,a){if(t||(t=e),f)return t.createDocumentFragment();a=a||o(t);for(var i=a.frag.cloneNode(),r=0,s=n(),c=s.length;c>r;r++)i.createElement(s[r]);return i}function s(t,e){e.cache||(e.cache={},e.createElem=t.createElement,e.createFrag=t.createDocumentFragment,e.frag=e.createFrag()),t.createElement=function(a){return v.shivMethods?i(a,t,e):e.createElem(a)},t.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+n().join().replace(/[\w\-]+/g,function(t){return e.createElem(t),e.frag.createElement(t),'c("'+t+'")'})+");return n}")(v,e.frag)}function c(t){t||(t=e);var n=o(t);return v.shivCSS&&!l&&!n.hasCSS&&(n.hasCSS=!!a(t,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),f||s(t,n),t}var l,f,d="3.7.0",u=t.html5||{},p=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,_=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,m="_html5shiv",g=0,h={};!function(){try{var t=e.createElement("a");t.innerHTML="<xyz></xyz>",l="hidden"in t,f=1==t.childNodes.length||function(){e.createElement("a");var t=e.createDocumentFragment();return"undefined"==typeof t.cloneNode||"undefined"==typeof t.createDocumentFragment||"undefined"==typeof t.createElement}()}catch(a){l=!0,f=!0}}();var v={elements:u.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:d,shivCSS:u.shivCSS!==!1,supportsUnknownElements:f,shivMethods:u.shivMethods!==!1,type:"default",shivDocument:c,createElement:i,createDocumentFragment:r};t.html5=v,c(e)}(this,e),_._version=p,_._prefixes=y,_._domPrefixes=x,_._cssomPrefixes=k,_.testProp=function(t){return s([t])},_.testAllProps=l,_.testStyles=z,g.className=g.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(m?" js "+C.join(" "):""),_}(this,this.document),function(t,e,a){function n(t){return"[object Function]"==g.call(t)}function o(t){return"string"==typeof t}function i(){}function r(t){return!t||"loaded"==t||"complete"==t||"uninitialized"==t}function s(){var t=h.shift();v=1,t?t.t?_(function(){("c"==t.t?u.injectCss:u.injectJs)(t.s,0,t.a,t.x,t.e,1)},0):(t(),s()):v=0}function c(t,a,n,o,i,c,l){function f(e){if(!p&&r(d.readyState)&&(w.r=p=1,!v&&s(),d.onload=d.onreadystatechange=null,e)){"img"!=t&&_(function(){b.removeChild(d)},50);for(var n in E[a])E[a].hasOwnProperty(n)&&E[a][n].onload()}}var l=l||u.errorTimeout,d=e.createElement(t),p=0,g=0,w={t:n,s:a,e:i,a:c,x:l};1===E[a]&&(g=1,E[a]=[]),"object"==t?d.data=a:(d.src=a,d.type=t),d.width=d.height="0",d.onerror=d.onload=d.onreadystatechange=function(){f.call(this,g)},h.splice(o,0,w),"img"!=t&&(g||2===E[a]?(b.insertBefore(d,y?null:m),_(f,l)):E[a].push(d))}function l(t,e,a,n,i){return v=0,e=e||"j",o(t)?c("c"==e?x:k,t,e,this.i++,a,n,i):(h.splice(this.i++,0,t),1==h.length&&s()),this}function f(){var t=u;return t.loader={load:l,i:0},t}var d,u,p=e.documentElement,_=t.setTimeout,m=e.getElementsByTagName("script")[0],g={}.toString,h=[],v=0,w="MozAppearance"in p.style,y=w&&!!e.createRange().compareNode,b=y?p:m.parentNode,p=t.opera&&"[object Opera]"==g.call(t.opera),p=!!e.attachEvent&&!p,k=w?"object":p?"script":"img",x=p?"script":k,j=Array.isArray||function(t){return"[object Array]"==g.call(t)},C=[],E={},z={timeout:function(t,e){return e.length&&(t.timeout=e[0]),t}};u=function(t){function e(t){var e,a,n,t=t.split("!"),o=C.length,i=t.pop(),r=t.length,i={url:i,origUrl:i,prefixes:t};for(a=0;r>a;a++)n=t[a].split("="),(e=z[n.shift()])&&(i=e(i,n));for(a=0;o>a;a++)i=C[a](i);return i}function r(t,o,i,r,s){var c=e(t),l=c.autoCallback;c.url.split(".").pop().split("?").shift(),c.bypass||(o&&(o=n(o)?o:o[t]||o[r]||o[t.split("/").pop().split("?")[0]]),c.instead?c.instead(t,o,i,r,s):(E[c.url]?c.noexec=!0:E[c.url]=1,i.load(c.url,c.forceCSS||!c.forceJS&&"css"==c.url.split(".").pop().split("?").shift()?"c":a,c.noexec,c.attrs,c.timeout),(n(o)||n(l))&&i.load(function(){f(),o&&o(c.origUrl,s,r),l&&l(c.origUrl,s,r),E[c.url]=2})))}function s(t,e){function a(t,a){if(t){if(o(t))a||(d=function(){var t=[].slice.call(arguments);u.apply(this,t),p()}),r(t,d,e,0,l);else if(Object(t)===t)for(c in s=function(){var e,a=0;for(e in t)t.hasOwnProperty(e)&&a++;return a}(),t)t.hasOwnProperty(c)&&(!a&&!--s&&(n(d)?d=function(){var t=[].slice.call(arguments);u.apply(this,t),p()}:d[c]=function(t){return function(){var e=[].slice.call(arguments);t&&t.apply(this,e),p()}}(u[c])),r(t[c],d,e,c,l))}else!a&&p()}var s,c,l=!!t.test,f=t.load||t.both,d=t.callback||i,u=d,p=t.complete||i;a(l?t.yep:t.nope,!!f),f&&a(f)}var c,l,d=this.yepnope.loader;if(o(t))r(t,0,d,0);else if(j(t))for(c=0;c<t.length;c++)l=t[c],o(l)?r(l,0,d,0):j(l)?u(l):Object(l)===l&&s(l,d);else Object(t)===t&&s(t,d)},u.addPrefix=function(t,e){z[t]=e},u.addFilter=function(t){C.push(t)},u.errorTimeout=1e4,null==e.readyState&&e.addEventListener&&(e.readyState="loading",e.addEventListener("DOMContentLoaded",d=function(){e.removeEventListener("DOMContentLoaded",d,0),e.readyState="complete"},0)),t.yepnope=f(),t.yepnope.executeStack=s,t.yepnope.injectJs=function(t,a,n,o,c,l){var f,d,p=e.createElement("script"),o=o||u.errorTimeout;p.src=t;for(d in n)p.setAttribute(d,n[d]);a=l?s:a||i,p.onreadystatechange=p.onload=function(){!f&&r(p.readyState)&&(f=1,a(),p.onload=p.onreadystatechange=null)},_(function(){f||(f=1,a(1))},o),c?p.onload():m.parentNode.insertBefore(p,m)},t.yepnope.injectCss=function(t,a,n,o,r,c){var l,o=e.createElement("link"),a=c?s:a||i;o.href=t,o.rel="stylesheet",o.type="text/css";for(l in n)o.setAttribute(l,n[l]);r||(m.parentNode.insertBefore(o,m),_(a,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},Modernizr.addTest("contenteditable","contentEditable"in document.documentElement);
"classList"in document.createElement("_")||!function(a){"use strict";if("Element"in a){var b="classList",c="prototype",d=a.Element[c],e=Object,f=String[c].trim||function(){return this.replace(/^\s+|\s+$/g,"")},g=Array[c].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},h=function(a,b){this.name=a,this.code=DOMException[a],this.message=b},i=function(a,b){if(""===b)throw new h("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(b))throw new h("INVALID_CHARACTER_ERR","String contains an invalid character");return g.call(a,b)},j=function(a){for(var b=f.call(a.getAttribute("class")||""),c=b?b.split(/\s+/):[],d=0,e=c.length;e>d;d++)this.push(c[d]);this._updateClassName=function(){a.setAttribute("class",this.toString())}},k=j[c]=[],l=function(){return new j(this)};if(h[c]=Error[c],k.item=function(a){return this[a]||null},k.contains=function(a){return a+="",-1!==i(this,a)},k.add=function(){var a,b=arguments,c=0,d=b.length,e=!1;do a=b[c]+"",-1===i(this,a)&&(this.push(a),e=!0);while(++c<d);e&&this._updateClassName()},k.remove=function(){var a,b,c=arguments,d=0,e=c.length,f=!1;do for(a=c[d]+"",b=i(this,a);-1!==b;)this.splice(b,1),f=!0,b=i(this,a);while(++d<e);f&&this._updateClassName()},k.toggle=function(a,b){a+="";var c=this.contains(a),d=c?b!==!0&&"remove":b!==!1&&"add";return d&&this[d](a),b===!0||b===!1?b:!c},k.toString=function(){return this.join(" ")},e.defineProperty){var m={get:l,enumerable:!0,configurable:!0};try{e.defineProperty(d,b,m)}catch(n){-2146823252===n.number&&(m.enumerable=!1,e.defineProperty(d,b,m))}}else e[c].__defineGetter__&&d.__defineGetter__(b,l)}}(self),function(a){"use strict";if(a.URL=a.URL||a.webkitURL,a.Blob&&a.URL)try{return void new Blob}catch(b){}var c=a.BlobBuilder||a.WebKitBlobBuilder||a.MozBlobBuilder||function(a){var b=function(a){return Object.prototype.toString.call(a).match(/^\[object\s(.*)\]$/)[1]},c=function(){this.data=[]},d=function(a,b,c){this.data=a,this.size=a.length,this.type=b,this.encoding=c},e=c.prototype,f=d.prototype,g=a.FileReaderSync,h=function(a){this.code=this[this.name=a]},i="NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "),j=i.length,k=a.URL||a.webkitURL||a,l=k.createObjectURL,m=k.revokeObjectURL,n=k,o=a.btoa,p=a.atob,q=a.ArrayBuffer,r=a.Uint8Array,s=/^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;for(d.fake=f.fake=!0;j--;)h.prototype[i[j]]=j+1;return k.createObjectURL||(n=a.URL=function(a){var b,c=document.createElementNS("http://www.w3.org/1999/xhtml","a");return c.href=a,"origin"in c||("data:"===c.protocol.toLowerCase()?c.origin=null:(b=a.match(s),c.origin=b&&b[1])),c}),n.createObjectURL=function(a){var b,c=a.type;return null===c&&(c="application/octet-stream"),a instanceof d?(b="data:"+c,"base64"===a.encoding?b+";base64,"+a.data:"URI"===a.encoding?b+","+decodeURIComponent(a.data):o?b+";base64,"+o(a.data):b+","+encodeURIComponent(a.data)):l?l.call(k,a):void 0},n.revokeObjectURL=function(a){"data:"!==a.substring(0,5)&&m&&m.call(k,a)},e.append=function(a){var c=this.data;if(r&&(a instanceof q||a instanceof r)){for(var e="",f=new r(a),i=0,j=f.length;j>i;i++)e+=String.fromCharCode(f[i]);c.push(e)}else if("Blob"===b(a)||"File"===b(a)){if(!g)throw new h("NOT_READABLE_ERR");var k=new g;c.push(k.readAsBinaryString(a))}else a instanceof d?"base64"===a.encoding&&p?c.push(p(a.data)):"URI"===a.encoding?c.push(decodeURIComponent(a.data)):"raw"===a.encoding&&c.push(a.data):("string"!=typeof a&&(a+=""),c.push(unescape(encodeURIComponent(a))))},e.getBlob=function(a){return arguments.length||(a=null),new d(this.data.join(""),a,"raw")},e.toString=function(){return"[object BlobBuilder]"},f.slice=function(a,b,c){var e=arguments.length;return 3>e&&(c=null),new d(this.data.slice(a,e>1?b:this.data.length),c,this.encoding)},f.toString=function(){return"[object Blob]"},f.close=function(){this.size=0,delete this.data},c}(a);a.Blob=function(a,b){var d=b?b.type||"":"",e=new c;if(a)for(var f=0,g=a.length;g>f;f++)e.append(Uint8Array&&a[f]instanceof Uint8Array?a[f].buffer:a[f]);var h=e.getBlob(d);return!h.slice&&h.webkitSlice&&(h.slice=h.webkitSlice),h};var d=Object.getPrototypeOf||function(a){return a.__proto__};a.Blob.prototype=d(new a.Blob)}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content||this),function(a,b){"use strict";"object"==typeof module?module.exports=b:"function"==typeof define&&define.amd?define(function(){return b}):a.MediumEditor=b}(this,function(){"use strict";function a(a,b){return this.init(a,b)}var b;!function(a){function c(a,b){var c,d=Array.prototype.slice.call(arguments,2);b=b||{};for(var e=0;e<d.length;e++){var f=d[e];if(f)for(c in f)f.hasOwnProperty(c)&&"undefined"!=typeof f[c]&&(a||b.hasOwnProperty(c)===!1)&&(b[c]=f[c])}return b}b={isIE:"Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent),isMac:a.navigator.platform.toUpperCase().indexOf("MAC")>=0,keyCode:{BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,DELETE:46,K:75},isMetaCtrlKey:function(a){return this.isMac&&a.metaKey||!this.isMac&&a.ctrlKey?!0:!1},isKey:function(a,b){var c=this.getKeyCode(a);return!1===Array.isArray(b)?c===b:-1===b.indexOf(c)?!1:!0},getKeyCode:function(a){var b=a.which;return null===b&&(b=null!==a.charCode?a.charCode:a.keyCode),b},blockContainerElementNames:["p","h1","h2","h3","h4","h5","h6","blockquote","pre"],emptyElementNames:["br","col","colgroup","hr","img","input","source","wbr"],extend:function(){var a=[!0].concat(Array.prototype.slice.call(arguments));return c.apply(this,a)},defaults:function(){var a=[!1].concat(Array.prototype.slice.call(arguments));return c.apply(this,a)},createLink:function(a,c,d,e){var f=a.createElement("a");return b.moveTextRangeIntoElement(c[0],c[c.length-1],f),f.setAttribute("href",d),e&&f.setAttribute("target",e),f},findOrCreateMatchingTextNodes:function(a,c,d){for(var e=a.createTreeWalker(c,NodeFilter.SHOW_TEXT,null,!1),f=[],g=0,h=!1,i=null,j=null;null!==(i=e.nextNode())&&(!h&&d.start<g+i.nodeValue.length&&(h=!0,j=b.splitStartNodeIfNeeded(i,d.start,g)),h&&b.splitEndNodeIfNeeded(i,j,d.end,g),!h||g!==d.end);){if(h&&g>d.end+1)throw new Error("PerformLinking overshot the target!");h&&f.push(j||i),g+=i.nodeValue.length,null!==j&&(g+=j.nodeValue.length,e.nextNode()),j=null}return f},splitStartNodeIfNeeded:function(a,b,c){return b!==c?a.splitText(b-c):null},splitEndNodeIfNeeded:function(a,b,c,d){var e,f;e=d+(b||a).nodeValue.length+(b?a.nodeValue.length:0)-1,f=(b||a).nodeValue.length-(e+1-c),e>=c&&d!==e&&0!==f&&(b||a).splitText(f)},findAdjacentTextNodeWithContent:function(a,b,c){var d,e=!1,f=c.createNodeIterator(a,NodeFilter.SHOW_TEXT,null,!1);for(d=f.nextNode();d;){if(d===b)e=!0;else if(e&&3===d.nodeType&&d.nodeValue&&d.nodeValue.trim().length>0)break;d=f.nextNode()}return d},isDescendant:function(a,b,c){if(!a||!b)return!1;if(c&&a===b)return!0;for(var d=b.parentNode;null!==d;){if(d===a)return!0;d=d.parentNode}return!1},isElement:function(a){return!(!a||1!==a.nodeType)},throttle:function(a,b){var c,d,e,f=50,g=null,h=0,i=function(){h=Date.now(),g=null,e=a.apply(c,d),g||(c=d=null)};return b||0===b||(b=f),function(){var f=Date.now(),j=b-(f-h);return c=this,d=arguments,0>=j||j>b?(g&&(clearTimeout(g),g=null),h=f,e=a.apply(c,d),g||(c=d=null)):g||(g=setTimeout(i,j)),e}},traverseUp:function(a,c){if(!a)return!1;do{if(1===a.nodeType){if(c(a))return a;if(b.isMediumEditorElement(a))return!1}a=a.parentNode}while(a);return!1},htmlEntities:function(a){return String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},insertHTMLCommand:function(a,c){var d,e,f,g,h,i,j;if(a.queryCommandSupported("insertHTML"))try{return a.execCommand("insertHTML",!1,c)}catch(k){}if(d=a.getSelection(),d.rangeCount){if(e=d.getRangeAt(0),j=e.commonAncestorContainer,3===j.nodeType&&0===e.startOffset&&e.endOffset===j.nodeValue.length||3!==j.nodeType&&j.innerHTML===e.toString()){for(;j.parentNode&&1===j.parentNode.childNodes.length&&!b.isMediumEditorElement(j.parentNode);)j=j.parentNode;e.selectNode(j)}for(e.deleteContents(),f=a.createElement("div"),f.innerHTML=c,g=a.createDocumentFragment();f.firstChild;)h=f.firstChild,i=g.appendChild(h);e.insertNode(g),i&&(e=e.cloneRange(),e.setStartAfter(i),e.collapse(!0),d.removeAllRanges(),d.addRange(e))}},execFormatBlock:function(a,c){var d=b.getTopBlockContainer(f.getSelectionStart(a));if("blockquote"===c){if(d){var e=Array.prototype.slice.call(d.childNodes);if(e.some(function(a){return b.isBlockContainer(a)}))return a.execCommand("outdent",!1,null)}if(this.isIE)return a.execCommand("indent",!1,c)}return d&&c===d.nodeName.toLowerCase()&&(c="p"),this.isIE&&(c="<"+c+">"),a.execCommand("formatBlock",!1,c)},setTargetBlank:function(a,b){var c,d=b||!1;if("a"===a.nodeName.toLowerCase())a.target="_blank";else for(a=a.getElementsByTagName("a"),c=0;c<a.length;c+=1)(!1===d||d===a[c].attributes.href.value)&&(a[c].target="_blank")},addClassToAnchors:function(a,b){var c,d,e=b.split(" ");if("a"===a.nodeName.toLowerCase())for(d=0;d<e.length;d+=1)a.classList.add(e[d]);else for(a=a.getElementsByTagName("a"),c=0;c<a.length;c+=1)for(d=0;d<e.length;d+=1)a[c].classList.add(e[d])},isListItem:function(a){if(!a)return!1;if("li"===a.nodeName.toLowerCase())return!0;for(var b=a.parentNode,c=b.nodeName.toLowerCase();!this.isBlockContainer(b)&&"div"!==c;){if("li"===c)return!0;if(b=b.parentNode,!b)return!1;c=b.nodeName.toLowerCase()}return!1},cleanListDOM:function(a,b){if("li"===b.nodeName.toLowerCase()){var c=b.parentElement;"p"===c.parentElement.nodeName.toLowerCase()&&(this.unwrap(c.parentElement,a),f.moveCursor(a,b.firstChild,b.firstChild.textContent.length))}},splitOffDOMTree:function(a,b,c){for(var d=b,e=null,f=!c;d!==a;){var g,h=d.parentNode,i=h.cloneNode(!1),j=f?d:h.firstChild;for(e&&(f?i.appendChild(e):g=e),e=i;j;){var k=j.nextSibling;j===d?(j.hasChildNodes()?j=j.cloneNode(!1):j.parentNode.removeChild(j),j.textContent&&e.appendChild(j),j=f?k:null):(j.parentNode.removeChild(j),(j.hasChildNodes()||j.textContent)&&e.appendChild(j),j=k)}g&&e.appendChild(g),d=h}return e},moveTextRangeIntoElement:function(a,b,c){if(!a||!b)return!1;var d=this.findCommonRoot(a,b);if(!d)return!1;if(b===a){var e=a.parentNode,f=a.nextSibling;return e.removeChild(a),c.appendChild(a),f?e.insertBefore(c,f):e.appendChild(c),c.hasChildNodes()}for(var g,h,i,j=[],k=0;k<d.childNodes.length;k++)if(i=d.childNodes[k],g){if(this.isDescendant(i,b,!0)){h=i;break}j.push(i)}else this.isDescendant(i,a,!0)&&(g=i);var l=h.nextSibling,m=d.ownerDocument.createDocumentFragment();return g===a?(g.parentNode.removeChild(g),m.appendChild(g)):m.appendChild(this.splitOffDOMTree(g,a)),j.forEach(function(a){a.parentNode.removeChild(a),m.appendChild(a)}),h===b?(h.parentNode.removeChild(h),m.appendChild(h)):m.appendChild(this.splitOffDOMTree(h,b,!0)),c.appendChild(m),h.parentNode===d?d.insertBefore(c,h):l?d.insertBefore(c,l):d.appendChild(c),c.hasChildNodes()},depthOfNode:function(a){for(var b=0,c=a;null!==c.parentNode;)c=c.parentNode,b++;return b},findCommonRoot:function(a,b){for(var c=this.depthOfNode(a),d=this.depthOfNode(b),e=a,f=b;c!==d;)c>d?(e=e.parentNode,c-=1):(f=f.parentNode,d-=1);for(;e!==f;)e=e.parentNode,f=f.parentNode;return e},isElementAtBeginningOfBlock:function(a){for(var b,c;!this.isBlockContainer(a)&&!this.isMediumEditorElement(a);){for(c=a;c=c.previousSibling;)if(b=3===c.nodeType?c.nodeValue:c.textContent,b.length>0)return!1;a=a.parentNode}return!0},isMediumEditorElement:function(a){return a&&a.getAttribute&&!!a.getAttribute("data-medium-editor-element")},getContainerEditorElement:function(a){return b.traverseUp(a,function(a){return b.isMediumEditorElement(a)})},isBlockContainer:function(a){return a&&3!==a.nodeType&&-1!==this.blockContainerElementNames.indexOf(a.nodeName.toLowerCase())},getClosestBlockContainer:function(a){return b.traverseUp(a,function(a){return b.isBlockContainer(a)})},getTopBlockContainer:function(a){var c=a;return this.traverseUp(a,function(a){return b.isBlockContainer(a)&&(c=a),!1}),c},getFirstSelectableLeafNode:function(a){for(;a&&a.firstChild;)a=a.firstChild;if(a=this.traverseUp(a,function(a){return-1===b.emptyElementNames.indexOf(a.nodeName.toLowerCase())}),"table"===a.nodeName.toLowerCase()){var c=a.querySelector("th, td");c&&(a=c)}return a},getFirstTextNode:function(a){if(3===a.nodeType)return a;for(var b=0;b<a.childNodes.length;b++){var c=this.getFirstTextNode(a.childNodes[b]);if(null!==c)return c}return null},ensureUrlHasProtocol:function(a){return-1===a.indexOf("://")?"http://"+a:a},warn:function(){void 0!==a.console&&"function"==typeof a.console.warn&&a.console.warn.apply(a.console,arguments)},deprecated:function(a,c,d){var e=a+" is deprecated, please use "+c+" instead.";d&&(e+=" Will be removed in "+d),b.warn(e)},deprecatedMethod:function(a,c,d,e){b.deprecated(a,c,e),"function"==typeof this[c]&&this[c].apply(this,d)},cleanupAttrs:function(a,b){b.forEach(function(b){a.removeAttribute(b)})},cleanupTags:function(a,b){b.forEach(function(b){a.nodeName.toLowerCase()===b&&a.parentNode.removeChild(a)},this)},getClosestTag:function(a,b){return this.traverseUp(a,function(a){return a.nodeName.toLowerCase()===b.toLowerCase()})},unwrap:function(a,b){for(var c=b.createDocumentFragment(),d=Array.prototype.slice.call(a.childNodes),e=0;e<d.length;e++)c.appendChild(d[e]);c.childNodes.length?a.parentNode.replaceChild(c,a):a.parentNode.removeChild(a)}}}(window);var c;!function(){c={bold:{name:"bold",action:"bold",aria:"bold",tagNames:["b","strong"],style:{prop:"font-weight",value:"700|bold"},useQueryState:!0,contentDefault:"<b>B</b>",contentFA:'<i class="fa fa-bold"></i>'},italic:{name:"italic",action:"italic",aria:"italic",tagNames:["i","em"],style:{prop:"font-style",value:"italic"},useQueryState:!0,contentDefault:"<b><i>I</i></b>",contentFA:'<i class="fa fa-italic"></i>'},underline:{name:"underline",action:"underline",aria:"underline",tagNames:["u"],style:{prop:"text-decoration",value:"underline"},useQueryState:!0,contentDefault:"<b><u>U</u></b>",contentFA:'<i class="fa fa-underline"></i>'},strikethrough:{name:"strikethrough",action:"strikethrough",aria:"strike through",tagNames:["strike"],style:{prop:"text-decoration",value:"line-through"},useQueryState:!0,contentDefault:"<s>A</s>",contentFA:'<i class="fa fa-strikethrough"></i>'},superscript:{name:"superscript",action:"superscript",aria:"superscript",tagNames:["sup"],contentDefault:"<b>x<sup>1</sup></b>",contentFA:'<i class="fa fa-superscript"></i>'},subscript:{name:"subscript",action:"subscript",aria:"subscript",tagNames:["sub"],contentDefault:"<b>x<sub>1</sub></b>",contentFA:'<i class="fa fa-subscript"></i>'},image:{name:"image",action:"image",aria:"image",tagNames:["img"],contentDefault:"<b>image</b>",contentFA:'<i class="fa fa-picture-o"></i>'},orderedlist:{name:"orderedlist",action:"insertorderedlist",aria:"ordered list",tagNames:["ol"],useQueryState:!0,contentDefault:"<b>1.</b>",contentFA:'<i class="fa fa-list-ol"></i>'},unorderedlist:{name:"unorderedlist",action:"insertunorderedlist",aria:"unordered list",tagNames:["ul"],useQueryState:!0,contentDefault:"<b>&bull;</b>",contentFA:'<i class="fa fa-list-ul"></i>'},indent:{name:"indent",action:"indent",aria:"indent",tagNames:[],contentDefault:"<b>&rarr;</b>",contentFA:'<i class="fa fa-indent"></i>'},outdent:{name:"outdent",action:"outdent",aria:"outdent",tagNames:[],contentDefault:"<b>&larr;</b>",contentFA:'<i class="fa fa-outdent"></i>'},justifyCenter:{name:"justifyCenter",action:"justifyCenter",aria:"center justify",tagNames:[],style:{prop:"text-align",value:"center"},contentDefault:"<b>C</b>",contentFA:'<i class="fa fa-align-center"></i>'},justifyFull:{name:"justifyFull",action:"justifyFull",aria:"full justify",tagNames:[],style:{prop:"text-align",value:"justify"},contentDefault:"<b>J</b>",contentFA:'<i class="fa fa-align-justify"></i>'},justifyLeft:{name:"justifyLeft",action:"justifyLeft",aria:"left justify",tagNames:[],style:{prop:"text-align",value:"left"},contentDefault:"<b>L</b>",contentFA:'<i class="fa fa-align-left"></i>'},justifyRight:{name:"justifyRight",action:"justifyRight",aria:"right justify",tagNames:[],style:{prop:"text-align",value:"right"},contentDefault:"<b>R</b>",contentFA:'<i class="fa fa-align-right"></i>'},removeFormat:{name:"removeFormat",aria:"remove formatting",action:"removeFormat",contentDefault:"<b>X</b>",contentFA:'<i class="fa fa-eraser"></i>'},quote:{name:"quote",action:"append-blockquote",aria:"blockquote",tagNames:["blockquote"],contentDefault:"<b>&ldquo;</b>",contentFA:'<i class="fa fa-quote-right"></i>'},pre:{name:"pre",action:"append-pre",aria:"preformatted text",tagNames:["pre"],contentDefault:"<b>0101</b>",contentFA:'<i class="fa fa-code fa-lg"></i>'},h1:{name:"h1",action:"append-h1",aria:"header type one",tagNames:["h1"],contentDefault:"<b>H1</b>",contentFA:'<i class="fa fa-header"><sup>1</sup>'},h2:{name:"h2",action:"append-h2",aria:"header type two",tagNames:["h2"],contentDefault:"<b>H2</b>",contentFA:'<i class="fa fa-header"><sup>2</sup>'},h3:{name:"h3",action:"append-h3",aria:"header type three",tagNames:["h3"],contentDefault:"<b>H3</b>",contentFA:'<i class="fa fa-header"><sup>3</sup>'},h4:{name:"h4",action:"append-h4",aria:"header type four",tagNames:["h4"],contentDefault:"<b>H4</b>",contentFA:'<i class="fa fa-header"><sup>4</sup>'},h5:{name:"h5",action:"append-h5",aria:"header type five",tagNames:["h5"],contentDefault:"<b>H5</b>",contentFA:'<i class="fa fa-header"><sup>5</sup>'},h6:{name:"h6",action:"append-h6",aria:"header type six",tagNames:["h6"],contentDefault:"<b>H6</b>",contentFA:'<i class="fa fa-header"><sup>6</sup>'}}}();var d;!function(){d={activeButtonClass:"medium-editor-button-active",buttonLabels:!1,delay:0,disableReturn:!1,disableDoubleReturn:!1,disableEditing:!1,autoLink:!1,elementsContainer:!1,contentWindow:window,ownerDocument:document,targetBlank:!1,extensions:{},spellcheck:!0}}();var e;!function(){e=function(a){b.extend(this,a)},e.extend=function(a){var c,d=this;c=a&&a.hasOwnProperty("constructor")?a.constructor:function(){return d.apply(this,arguments)},b.extend(c,d);var e=function(){this.constructor=c};return e.prototype=d.prototype,c.prototype=new e,a&&b.extend(c.prototype,a),c},e.prototype={init:function(){},base:void 0,name:void 0,checkState:void 0,destroy:void 0,queryCommandState:void 0,isActive:void 0,isAlreadyApplied:void 0,setActive:void 0,setInactive:void 0,window:void 0,document:void 0,getEditorElements:function(){return this.base.elements},getEditorId:function(){return this.base.id},getEditorOption:function(a){return this.base.options[a]}},["execAction","on","off","subscribe","trigger"].forEach(function(a){e.prototype[a]=function(){return this.base[a].apply(this.base,arguments)}})}();var f;!function(){function a(a){return b.isBlockContainer(a)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}f={findMatchingSelectionParent:function(a,c){var d,e,f=c.getSelection();return 0===f.rangeCount?!1:(d=f.getRangeAt(0),e=d.commonAncestorContainer,b.traverseUp(e,a))},getSelectionElement:function(a){return this.findMatchingSelectionParent(function(a){return b.isMediumEditorElement(a)},a)},exportSelection:function(a,b){if(!a)return null;var c=null,d=b.getSelection();if(d.rangeCount>0){var e,f=d.getRangeAt(0),g=f.cloneRange();if(g.selectNodeContents(a),g.setEnd(f.startContainer,f.startOffset),e=g.toString().length,c={start:e,end:e+f.toString().length},0!==e){var h=this.getIndexRelativeToAdjacentEmptyBlocks(b,a,f.startContainer,f.startOffset);0!==h&&(c.emptyBlocksIndex=h)}}return c},importSelection:function(a,c,d,e){if(a&&c){var g=d.createRange();g.setStart(c,0),g.collapse(!0);for(var h,i=c,j=[],k=0,l=!1,m=!1;!m&&i;){if(3===i.nodeType)h=k+i.length,!l&&a.start>=k&&a.start<=h&&(g.setStart(i,a.start-k),l=!0),l&&a.end>=k&&a.end<=h&&(g.setEnd(i,a.end-k),m=!0),k=h;else for(var n=i.childNodes.length-1;n>=0;)j.push(i.childNodes[n]),n-=1;m||(i=j.pop())}if(a.emptyBlocksIndex){for(var o=b.getTopBlockContainer(g.startContainer),p=0;p<a.emptyBlocksIndex&&o.nextSibling&&(o=o.nextSibling,p++,!(o.textContent.length>0)););g.setStart(b.getFirstSelectableLeafNode(o),0)}e&&(g=f.importSelectionMoveCursorPastAnchor(a,g));var q=d.getSelection();q.removeAllRanges(),q.addRange(g)}},importSelectionMoveCursorPastAnchor:function(a,c){var d=function(a){return"a"===a.nodeName.toLowerCase()};if(a.start===a.end&&3===c.startContainer.nodeType&&c.startOffset===c.startContainer.nodeValue.length&&b.traverseUp(c.startContainer,d)){for(var e=c.startContainer,f=c.startContainer.parentNode;null!==f&&"a"!==f.nodeName.toLowerCase();)f.childNodes[f.childNodes.length-1]!==e?f=null:(e=f,f=f.parentNode);if(null!==f&&"a"===f.nodeName.toLowerCase()){for(var g=null,h=0;null===g&&h<f.parentNode.childNodes.length;h++)f.parentNode.childNodes[h]===f&&(g=h);c.setStart(f.parentNode,g+1),c.collapse(!0)}}return c},getIndexRelativeToAdjacentEmptyBlocks:function(c,d,e,f){if(3===e.nodeType&&f>0)return 0;var g=e;if(3!==g.nodeType&&(g=e.childNodes[f]),g&&!b.isElementAtBeginningOfBlock(g))return 0;for(var h=c.createTreeWalker(d,NodeFilter.SHOW_ELEMENT,a,!1),i=0;h.nextNode();){var j=""===h.currentNode.textContent;if((j||i>0)&&(i+=1),b.isDescendant(h.currentNode,e,!0))return i;j||(i=0)}return i},selectionInContentEditableFalse:function(a){var b,c=this.findMatchingSelectionParent(function(a){var c=a&&a.getAttribute("contenteditable");return"true"===c&&(b=!0),"#text"!==a.nodeName&&"false"===c},a);return!b&&c},getSelectionHtml:function(a){var b,c,d,e="",f=a.getSelection();if(f.rangeCount){for(d=a.createElement("div"),b=0,c=f.rangeCount;c>b;b+=1)d.appendChild(f.getRangeAt(b).cloneContents());e=d.innerHTML}return e},getCaretOffsets:function(a,b){var c,d;return b||(b=window.getSelection().getRangeAt(0)),c=b.cloneRange(),d=b.cloneRange(),c.selectNodeContents(a),c.setEnd(b.endContainer,b.endOffset),d.selectNodeContents(a),d.setStart(b.endContainer,b.endOffset),{left:c.toString().length,right:d.toString().length}},rangeSelectsSingleNode:function(a){var b=a.startContainer;return b===a.endContainer&&b.hasChildNodes()&&a.endOffset===a.startOffset+1},getSelectedParentElement:function(a){return a?this.rangeSelectsSingleNode(a)&&3!==a.startContainer.childNodes[a.startOffset].nodeType?a.startContainer.childNodes[a.startOffset]:3===a.startContainer.nodeType?a.startContainer.parentNode:a.startContainer:null},getSelectedElements:function(a){var b,c,d,e=a.getSelection();if(!e.rangeCount||e.isCollapsed||!e.getRangeAt(0).commonAncestorContainer)return[];if(b=e.getRangeAt(0),3===b.commonAncestorContainer.nodeType){for(c=[],d=b.commonAncestorContainer;d.parentNode&&1===d.parentNode.childNodes.length;)c.push(d.parentNode),d=d.parentNode;return c}return[].filter.call(b.commonAncestorContainer.getElementsByTagName("*"),function(a){return"function"==typeof e.containsNode?e.containsNode(a,!0):!0})},selectNode:function(a,b){var c=b.createRange(),d=b.getSelection();c.selectNodeContents(a),d.removeAllRanges(),d.addRange(c)},select:function(a,b,c,d,e){a.getSelection().removeAllRanges();var f=a.createRange();return f.setStart(b,c),d?f.setEnd(d,e):f.collapse(!0),a.getSelection().addRange(f),f},moveCursor:function(a,b,c){this.select(a,b,c)},getSelectionRange:function(a){var b=a.getSelection();return 0===b.rangeCount?null:b.getRangeAt(0)},getSelectionStart:function(a){var b=a.getSelection().anchorNode,c=b&&3===b.nodeType?b.parentNode:b;return c}}}();var g;!function(){g=function(a){this.base=a,this.options=this.base.options,this.events=[],this.disabledEvents={},this.customEvents={},this.listeners={}},g.prototype={InputEventOnContenteditableSupported:!b.isIE,attachDOMEvent:function(a,b,c,d){a.addEventListener(b,c,d),this.events.push([a,b,c,d])},detachDOMEvent:function(a,b,c,d){var e,f=this.indexOfListener(a,b,c,d);-1!==f&&(e=this.events.splice(f,1)[0],e[0].removeEventListener(e[1],e[2],e[3]))},indexOfListener:function(a,b,c,d){var e,f,g;for(e=0,f=this.events.length;f>e;e+=1)if(g=this.events[e],g[0]===a&&g[1]===b&&g[2]===c&&g[3]===d)return e;return-1},detachAllDOMEvents:function(){for(var a=this.events.pop();a;)a[0].removeEventListener(a[1],a[2],a[3]),a=this.events.pop()},enableCustomEvent:function(a){void 0!==this.disabledEvents[a]&&delete this.disabledEvents[a]},disableCustomEvent:function(a){this.disabledEvents[a]=!0},attachCustomEvent:function(a,b){this.setupListener(a),this.customEvents[a]||(this.customEvents[a]=[]),this.customEvents[a].push(b)},detachCustomEvent:function(a,b){var c=this.indexOfCustomListener(a,b);-1!==c&&this.customEvents[a].splice(c,1)},indexOfCustomListener:function(a,b){return this.customEvents[a]&&this.customEvents[a].length?this.customEvents[a].indexOf(b):-1},detachAllCustomEvents:function(){this.customEvents={}},triggerCustomEvent:function(a,b,c){this.customEvents[a]&&!this.disabledEvents[a]&&this.customEvents[a].forEach(function(a){a(b,c)})},destroy:function(){this.detachAllDOMEvents(),this.detachAllCustomEvents(),this.detachExecCommand(),this.base.elements&&this.base.elements.forEach(function(a){a.removeAttribute("data-medium-focused")})},attachToExecCommand:function(){this.execCommandListener||(this.execCommandListener=function(a){this.handleDocumentExecCommand(a)}.bind(this),this.wrapExecCommand(),this.options.ownerDocument.execCommand.listeners.push(this.execCommandListener))},detachExecCommand:function(){var a=this.options.ownerDocument;if(this.execCommandListener&&a.execCommand.listeners){var b=a.execCommand.listeners.indexOf(this.execCommandListener);-1!==b&&a.execCommand.listeners.splice(b,1),a.execCommand.listeners.length||this.unwrapExecCommand()}},wrapExecCommand:function(){var a=this.options.ownerDocument;if(!a.execCommand.listeners){var b=function(b,c,d){var e=a.execCommand.orig.apply(this,arguments);if(!a.execCommand.listeners)return e;var f=Array.prototype.slice.call(arguments);return a.execCommand.listeners.forEach(function(a){a({command:b,value:d,args:f,result:e})}),e};b.orig=a.execCommand,b.listeners=[],a.execCommand=b}},unwrapExecCommand:function(){var a=this.options.ownerDocument;a.execCommand.orig&&(a.execCommand=a.execCommand.orig)},setupListener:function(a){if(!this.listeners[a]){switch(a){case"externalInteraction":this.attachDOMEvent(this.options.ownerDocument.body,"mousedown",this.handleBodyMousedown.bind(this),!0),this.attachDOMEvent(this.options.ownerDocument.body,"click",this.handleBodyClick.bind(this),!0),this.attachDOMEvent(this.options.ownerDocument.body,"focus",this.handleBodyFocus.bind(this),!0);break;case"blur":this.setupListener("externalInteraction");break;case"focus":this.setupListener("externalInteraction");break;case"editableInput":this.contentCache=[],this.base.elements.forEach(function(a){this.contentCache[a.getAttribute("medium-editor-index")]=a.innerHTML,this.InputEventOnContenteditableSupported&&this.attachDOMEvent(a,"input",this.handleInput.bind(this))}.bind(this)),this.InputEventOnContenteditableSupported||(this.setupListener("editableKeypress"),this.keypressUpdateInput=!0,this.attachDOMEvent(document,"selectionchange",this.handleDocumentSelectionChange.bind(this)),this.attachToExecCommand());break;case"editableClick":this.attachToEachElement("click",this.handleClick);break;case"editableBlur":this.attachToEachElement("blur",this.handleBlur);break;case"editableKeypress":this.attachToEachElement("keypress",this.handleKeypress);break;case"editableKeyup":this.attachToEachElement("keyup",this.handleKeyup);break;case"editableKeydown":this.attachToEachElement("keydown",this.handleKeydown);break;case"editableKeydownEnter":this.setupListener("editableKeydown");break;case"editableKeydownTab":this.setupListener("editableKeydown");break;case"editableKeydownDelete":this.setupListener("editableKeydown");break;case"editableMouseover":this.attachToEachElement("mouseover",this.handleMouseover);break;case"editableDrag":this.attachToEachElement("dragover",this.handleDragging),this.attachToEachElement("dragleave",this.handleDragging);break;case"editableDrop":this.attachToEachElement("drop",this.handleDrop);break;case"editablePaste":this.attachToEachElement("paste",this.handlePaste)}this.listeners[a]=!0}},attachToEachElement:function(a,b){this.base.elements.forEach(function(c){this.attachDOMEvent(c,a,b.bind(this))},this)},focusElement:function(a){a.focus(),this.updateFocus(a,{target:a,type:"focus"})},updateFocus:function(a,c){var d,e=this.base.getExtensionByName("toolbar"),f=e?e.getToolbarElement():null,g=this.base.getExtensionByName("anchor-preview"),h=g&&g.getPreviewElement?g.getPreviewElement():null,i=this.base.getFocusedElement();i&&"click"===c.type&&this.lastMousedownTarget&&(b.isDescendant(i,this.lastMousedownTarget,!0)||b.isDescendant(f,this.lastMousedownTarget,!0)||b.isDescendant(h,this.lastMousedownTarget,!0))&&(d=i),d||this.base.elements.some(function(c){return!d&&b.isDescendant(c,a,!0)&&(d=c),!!d},this);var j=!b.isDescendant(i,a,!0)&&!b.isDescendant(f,a,!0)&&!b.isDescendant(h,a,!0);d!==i&&(i&&j&&(i.removeAttribute("data-medium-focused"),this.triggerCustomEvent("blur",c,i)),d&&(d.setAttribute("data-medium-focused",!0),this.triggerCustomEvent("focus",c,d))),j&&this.triggerCustomEvent("externalInteraction",c)},updateInput:function(a,b){if(this.contentCache){var c=a.getAttribute("medium-editor-index");a.innerHTML!==this.contentCache[c]&&this.triggerCustomEvent("editableInput",b,a),this.contentCache[c]=a.innerHTML}},handleDocumentSelectionChange:function(a){if(a.currentTarget&&a.currentTarget.activeElement){var c,d=a.currentTarget.activeElement;this.base.elements.some(function(a){return b.isDescendant(a,d,!0)?(c=a,!0):!1},this),c&&this.updateInput(c,{target:d,currentTarget:c})}},handleDocumentExecCommand:function(){var a=this.base.getFocusedElement();a&&this.updateInput(a,{target:a,currentTarget:a})},handleBodyClick:function(a){this.updateFocus(a.target,a)},handleBodyFocus:function(a){this.updateFocus(a.target,a)},handleBodyMousedown:function(a){this.lastMousedownTarget=a.target},handleInput:function(a){this.updateInput(a.currentTarget,a)},handleClick:function(a){this.triggerCustomEvent("editableClick",a,a.currentTarget)},handleBlur:function(a){this.triggerCustomEvent("editableBlur",a,a.currentTarget)},handleKeypress:function(a){if(this.triggerCustomEvent("editableKeypress",a,a.currentTarget),this.keypressUpdateInput){var b={target:a.target,currentTarget:a.currentTarget};setTimeout(function(){this.updateInput(b.currentTarget,b)}.bind(this),0)}},handleKeyup:function(a){this.triggerCustomEvent("editableKeyup",a,a.currentTarget)},handleMouseover:function(a){this.triggerCustomEvent("editableMouseover",a,a.currentTarget)},handleDragging:function(a){this.triggerCustomEvent("editableDrag",a,a.currentTarget)},handleDrop:function(a){this.triggerCustomEvent("editableDrop",a,a.currentTarget)},handlePaste:function(a){this.triggerCustomEvent("editablePaste",a,a.currentTarget)},handleKeydown:function(a){return this.triggerCustomEvent("editableKeydown",a,a.currentTarget),b.isKey(a,b.keyCode.ENTER)?this.triggerCustomEvent("editableKeydownEnter",a,a.currentTarget):b.isKey(a,b.keyCode.TAB)?this.triggerCustomEvent("editableKeydownTab",a,a.currentTarget):b.isKey(a,[b.keyCode.DELETE,b.keyCode.BACKSPACE])?this.triggerCustomEvent("editableKeydownDelete",a,a.currentTarget):void 0}}}();var h;!function(){h=e.extend({action:void 0,aria:void 0,tagNames:void 0,style:void 0,useQueryState:void 0,contentDefault:void 0,contentFA:void 0,classList:void 0,attrs:void 0,defaults:c,constructor:function(a){h.isBuiltInButton(a)?e.call(this,this.defaults[a]):e.call(this,a)},init:function(){e.prototype.init.apply(this,arguments),this.button=this.createButton(),this.on(this.button,"click",this.handleClick.bind(this))},getButton:function(){return this.button},getAction:function(){return"function"==typeof this.action?this.action(this.base.options):this.action},getAria:function(){return"function"==typeof this.aria?this.aria(this.base.options):this.aria},getTagNames:function(){return"function"==typeof this.tagNames?this.tagNames(this.base.options):this.tagNames;

},createButton:function(){var a=this.document.createElement("button"),b=this.contentDefault,c=this.getAria(),d=this.getEditorOption("buttonLabels");return a.classList.add("medium-editor-action"),a.classList.add("medium-editor-action-"+this.name),this.classList&&this.classList.forEach(function(b){a.classList.add(b)}),a.setAttribute("data-action",this.getAction()),c&&(a.setAttribute("title",c),a.setAttribute("aria-label",c)),this.attrs&&Object.keys(this.attrs).forEach(function(b){a.setAttribute(b,this.attrs[b])},this),"fontawesome"===d&&this.contentFA&&(b=this.contentFA),a.innerHTML=b,a},handleClick:function(a){a.preventDefault(),a.stopPropagation();var b=this.getAction();b&&this.execAction(b)},isActive:function(){return this.button.classList.contains(this.getEditorOption("activeButtonClass"))},setInactive:function(){this.button.classList.remove(this.getEditorOption("activeButtonClass")),delete this.knownState},setActive:function(){this.button.classList.add(this.getEditorOption("activeButtonClass")),delete this.knownState},queryCommandState:function(){var a=null;return this.useQueryState&&(a=this.base.queryCommandState(this.getAction())),a},isAlreadyApplied:function(a){var b,c,d=!1,e=this.getTagNames();return this.knownState===!1||this.knownState===!0?this.knownState:(e&&e.length>0&&(d=-1!==e.indexOf(a.nodeName.toLowerCase())),!d&&this.style&&(b=this.style.value.split("|"),c=this.window.getComputedStyle(a,null).getPropertyValue(this.style.prop),b.forEach(function(a){this.knownState||(d=-1!==c.indexOf(a),(d||"text-decoration"!==this.style.prop)&&(this.knownState=d))},this)),d)}}),h.isBuiltInButton=function(a){return"string"==typeof a&&h.prototype.defaults.hasOwnProperty(a)}}();var i;!function(){var a=function(){};i=h.extend({init:function(){h.prototype.init.apply(this,arguments)},formSaveLabel:"&#10003;",formCloseLabel:"&times;",hasForm:!0,getForm:a,isDisplayed:a,hideForm:a,showToolbarDefaultActions:function(){var a=this.base.getExtensionByName("toolbar");a&&a.showToolbarDefaultActions()},hideToolbarDefaultActions:function(){var a=this.base.getExtensionByName("toolbar");a&&a.hideToolbarDefaultActions()},setToolbarPosition:function(){var a=this.base.getExtensionByName("toolbar");a&&a.setToolbarPosition()}})}();var j;!function(){j=i.extend({customClassOption:null,customClassOptionText:"Button",linkValidation:!1,placeholderText:"Paste or type a link",targetCheckbox:!1,targetCheckboxText:"Open in new window",name:"anchor",action:"createLink",aria:"link",tagNames:["a"],contentDefault:"<b>#</b>",contentFA:'<i class="fa fa-link"></i>',init:function(){i.prototype.init.apply(this,arguments),this.subscribe("editableKeydown",this.handleKeydown.bind(this))},handleClick:function(a){a.preventDefault(),a.stopPropagation();var c=f.getSelectionRange(this.document);return"a"===c.startContainer.nodeName.toLowerCase()||"a"===c.endContainer.nodeName.toLowerCase()||b.getClosestTag(f.getSelectedParentElement(c),"a")?this.execAction("unlink"):(this.isDisplayed()||this.showForm(),!1)},handleKeydown:function(a){b.isKey(a,b.keyCode.K)&&b.isMetaCtrlKey(a)&&!a.shiftKey&&this.handleClick(a)},getForm:function(){return this.form||(this.form=this.createForm()),this.form},getTemplate:function(){var a=['<input type="text" class="medium-editor-toolbar-input" placeholder="',this.placeholderText,'">'];return a.push('<a href="#" class="medium-editor-toolbar-save">',"fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':this.formSaveLabel,"</a>"),a.push('<a href="#" class="medium-editor-toolbar-close">',"fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':this.formCloseLabel,"</a>"),this.targetCheckbox&&a.push('<div class="medium-editor-toolbar-form-row">','<input type="checkbox" class="medium-editor-toolbar-anchor-target">',"<label>",this.targetCheckboxText,"</label>","</div>"),this.customClassOption&&a.push('<div class="medium-editor-toolbar-form-row">','<input type="checkbox" class="medium-editor-toolbar-anchor-button">',"<label>",this.customClassOptionText,"</label>","</div>"),a.join("")},isDisplayed:function(){return"block"===this.getForm().style.display},hideForm:function(){this.getForm().style.display="none",this.getInput().value=""},showForm:function(a){var b=this.getInput(),c=this.getAnchorTargetCheckbox(),d=this.getAnchorButtonCheckbox();if(a=a||{url:""},"string"==typeof a&&(a={url:a}),this.base.saveSelection(),this.hideToolbarDefaultActions(),this.getForm().style.display="block",this.setToolbarPosition(),b.value=a.url,b.focus(),c&&(c.checked="_blank"===a.target),d){var e=a.buttonClass?a.buttonClass.split(" "):[];d.checked=-1!==e.indexOf(this.customClassOption)}},destroy:function(){return this.form?(this.form.parentNode&&this.form.parentNode.removeChild(this.form),void delete this.form):!1},getFormOpts:function(){var a=this.getAnchorTargetCheckbox(),b=this.getAnchorButtonCheckbox(),c={url:this.getInput().value};return this.linkValidation&&(c.url=this.checkLinkFormat(c.url)),c.target="_self",a&&a.checked&&(c.target="_blank"),b&&b.checked&&(c.buttonClass=this.customClassOption),c},doFormSave:function(){var a=this.getFormOpts();this.completeFormSave(a)},completeFormSave:function(a){this.base.restoreSelection(),this.execAction(this.action,a),this.base.checkSelection()},checkLinkFormat:function(a){var b=/^(https?|ftps?|rtmpt?):\/\/|mailto:/;return(b.test(a)?"":"http://")+a},doFormCancel:function(){this.base.restoreSelection(),this.base.checkSelection()},attachFormEvents:function(a){var b=a.querySelector(".medium-editor-toolbar-close"),c=a.querySelector(".medium-editor-toolbar-save"),d=a.querySelector(".medium-editor-toolbar-input");this.on(a,"click",this.handleFormClick.bind(this)),this.on(d,"keyup",this.handleTextboxKeyup.bind(this)),this.on(b,"click",this.handleCloseClick.bind(this)),this.on(c,"click",this.handleSaveClick.bind(this),!0)},createForm:function(){var a=this.document,b=a.createElement("div");return b.className="medium-editor-toolbar-form",b.id="medium-editor-toolbar-form-anchor-"+this.getEditorId(),b.innerHTML=this.getTemplate(),this.attachFormEvents(b),b},getInput:function(){return this.getForm().querySelector("input.medium-editor-toolbar-input")},getAnchorTargetCheckbox:function(){return this.getForm().querySelector(".medium-editor-toolbar-anchor-target")},getAnchorButtonCheckbox:function(){return this.getForm().querySelector(".medium-editor-toolbar-anchor-button")},handleTextboxKeyup:function(a){return a.keyCode===b.keyCode.ENTER?(a.preventDefault(),void this.doFormSave()):void(a.keyCode===b.keyCode.ESCAPE&&(a.preventDefault(),this.doFormCancel()))},handleFormClick:function(a){a.stopPropagation()},handleSaveClick:function(a){a.preventDefault(),this.doFormSave()},handleCloseClick:function(a){a.preventDefault(),this.doFormCancel()}})}();var k;!function(){k=e.extend({name:"anchor-preview",hideDelay:500,previewValueSelector:"a",init:function(){this.anchorPreview=this.createPreview(),this.getEditorOption("elementsContainer").appendChild(this.anchorPreview),this.attachToEditables()},getPreviewElement:function(){return this.anchorPreview},createPreview:function(){var a=this.document.createElement("div");return a.id="medium-editor-anchor-preview-"+this.getEditorId(),a.className="medium-editor-anchor-preview",a.innerHTML=this.getTemplate(),this.on(a,"click",this.handleClick.bind(this)),a},getTemplate:function(){return'<div class="medium-editor-toolbar-anchor-preview" id="medium-editor-toolbar-anchor-preview">    <a class="medium-editor-toolbar-anchor-preview-inner"></a></div>'},destroy:function(){this.anchorPreview&&(this.anchorPreview.parentNode&&this.anchorPreview.parentNode.removeChild(this.anchorPreview),delete this.anchorPreview)},hidePreview:function(){this.anchorPreview.classList.remove("medium-editor-anchor-preview-active"),this.activeAnchor=null},showPreview:function(a){return this.anchorPreview.classList.contains("medium-editor-anchor-preview-active")||a.getAttribute("data-disable-preview")?!0:(this.previewValueSelector&&(this.anchorPreview.querySelector(this.previewValueSelector).textContent=a.attributes.href.value,this.anchorPreview.querySelector(this.previewValueSelector).href=a.attributes.href.value),this.anchorPreview.classList.add("medium-toolbar-arrow-over"),this.anchorPreview.classList.remove("medium-toolbar-arrow-under"),this.anchorPreview.classList.contains("medium-editor-anchor-preview-active")||this.anchorPreview.classList.add("medium-editor-anchor-preview-active"),this.activeAnchor=a,this.positionPreview(),this.attachPreviewHandlers(),this)},positionPreview:function(a){a=a||this.activeAnchor;var b,c,d=this.anchorPreview.offsetHeight,e=a.getBoundingClientRect(),f=(e.left+e.right)/2,g=this.diffLeft,h=this.diffTop;b=this.anchorPreview.offsetWidth/2;var i=this.base.getExtensionByName("toolbar");i&&(g=i.diffLeft,h=i.diffTop),c=g-b,this.anchorPreview.style.top=Math.round(d+e.bottom-h+this.window.pageYOffset-this.anchorPreview.offsetHeight)+"px",b>f?this.anchorPreview.style.left=c+b+"px":this.window.innerWidth-f<b?this.anchorPreview.style.left=this.window.innerWidth+c-b+"px":this.anchorPreview.style.left=c+f+"px"},attachToEditables:function(){this.subscribe("editableMouseover",this.handleEditableMouseover.bind(this))},handleClick:function(a){var b=this.base.getExtensionByName("anchor"),c=this.activeAnchor;b&&c&&(a.preventDefault(),this.base.selectElement(this.activeAnchor),this.base.delay(function(){if(c){var a={url:c.attributes.href.value,target:c.getAttribute("target"),buttonClass:c.getAttribute("class")};b.showForm(a),c=null}}.bind(this))),this.hidePreview()},handleAnchorMouseout:function(){this.anchorToPreview=null,this.off(this.activeAnchor,"mouseout",this.instanceHandleAnchorMouseout),this.instanceHandleAnchorMouseout=null},handleEditableMouseover:function(a){var c=b.getClosestTag(a.target,"a");if(!1!==c){if(!/href=["']\S+["']/.test(c.outerHTML)||/href=["']#\S+["']/.test(c.outerHTML))return!0;var d=this.base.getExtensionByName("toolbar");if(d&&d.isDisplayed&&d.isDisplayed())return!0;this.activeAnchor&&this.activeAnchor!==c&&this.detachPreviewHandlers(),this.anchorToPreview=c,this.instanceHandleAnchorMouseout=this.handleAnchorMouseout.bind(this),this.on(this.anchorToPreview,"mouseout",this.instanceHandleAnchorMouseout),this.base.delay(function(){this.anchorToPreview&&this.showPreview(this.anchorToPreview)}.bind(this))}},handlePreviewMouseover:function(){this.lastOver=(new Date).getTime(),this.hovering=!0},handlePreviewMouseout:function(a){a.relatedTarget&&/anchor-preview/.test(a.relatedTarget.className)||(this.hovering=!1)},updatePreview:function(){if(this.hovering)return!0;var a=(new Date).getTime()-this.lastOver;a>this.hideDelay&&this.detachPreviewHandlers()},detachPreviewHandlers:function(){clearInterval(this.intervalTimer),this.instanceHandlePreviewMouseover&&(this.off(this.anchorPreview,"mouseover",this.instanceHandlePreviewMouseover),this.off(this.anchorPreview,"mouseout",this.instanceHandlePreviewMouseout),this.activeAnchor&&(this.off(this.activeAnchor,"mouseover",this.instanceHandlePreviewMouseover),this.off(this.activeAnchor,"mouseout",this.instanceHandlePreviewMouseout))),this.hidePreview(),this.hovering=this.instanceHandlePreviewMouseover=this.instanceHandlePreviewMouseout=null},attachPreviewHandlers:function(){this.lastOver=(new Date).getTime(),this.hovering=!0,this.instanceHandlePreviewMouseover=this.handlePreviewMouseover.bind(this),this.instanceHandlePreviewMouseout=this.handlePreviewMouseout.bind(this),this.intervalTimer=setInterval(this.updatePreview.bind(this),200),this.on(this.anchorPreview,"mouseover",this.instanceHandlePreviewMouseover),this.on(this.anchorPreview,"mouseout",this.instanceHandlePreviewMouseout),this.on(this.activeAnchor,"mouseover",this.instanceHandlePreviewMouseover),this.on(this.activeAnchor,"mouseout",this.instanceHandlePreviewMouseout)}})}();var l,m,n,o;m=[" ","	","\n","\r"," "," "," "," "," ","\u2028","\u2029"],n="com|net|org|edu|gov|mil|aero|asia|biz|cat|coop|info|int|jobs|mobi|museum|name|post|pro|tel|travel|xxx|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cs|cu|cv|cx|cy|cz|dd|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|ja|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw",o="(((?:(https?://|ftps?://|nntp://)|www\\d{0,3}[.]|[a-z0-9.\\-]+[.]("+n+")\\/)\\S+(?:[^\\s`!\\[\\]{};:'\".,?«»“”‘’])))|(([a-z0-9\\-]+\\.)?[a-z0-9\\-]+\\.("+n+"))",function(){function a(a){return!b.getClosestTag(a,"a")}var c=new RegExp("^("+n+")$","i");l=e.extend({init:function(){e.prototype.init.apply(this,arguments),this.disableEventHandling=!1,this.subscribe("editableKeypress",this.onKeypress.bind(this)),this.subscribe("editableBlur",this.onBlur.bind(this)),this.document.execCommand("AutoUrlDetect",!1,!1)},destroy:function(){this.document.queryCommandSupported("AutoUrlDetect")&&this.document.execCommand("AutoUrlDetect",!1,!0)},onBlur:function(a,b){this.performLinking(b)},onKeypress:function(a){this.disableEventHandling||b.isKey(a,[b.keyCode.SPACE,b.keyCode.ENTER])&&(clearTimeout(this.performLinkingTimeout),this.performLinkingTimeout=setTimeout(function(){try{var b=this.base.exportSelection();this.performLinking(a.target)&&this.base.importSelection(b,!0)}catch(c){window.console&&window.console.error("Failed to perform linking",c),this.disableEventHandling=!0}}.bind(this),0))},performLinking:function(a){var b=a.querySelectorAll("p"),c=!1;0===b.length&&(b=[a]);for(var d=0;d<b.length;d++)c=this.removeObsoleteAutoLinkSpans(b[d])||c,c=this.performLinkingWithinElement(b[d])||c;return c},removeObsoleteAutoLinkSpans:function(c){for(var d=c.querySelectorAll('span[data-auto-link="true"]'),e=!1,f=0;f<d.length;f++){var g=d[f].textContent;if(-1===g.indexOf("://")&&(g=b.ensureUrlHasProtocol(g)),d[f].getAttribute("data-href")!==g&&a(d[f])){e=!0;var h=g.replace(/\s+$/,"");if(d[f].getAttribute("data-href")===h){var i=g.length-h.length,j=b.splitOffDOMTree(d[f],this.splitTextBeforeEnd(d[f],i));d[f].parentNode.insertBefore(j,d[f].nextSibling)}else b.unwrap(d[f],this.document)}}return e},splitTextBeforeEnd:function(a,b){for(var c=this.document.createTreeWalker(a,NodeFilter.SHOW_TEXT,null,!1),d=!0;d;)d=null!==c.lastChild();for(var e,f,g;b>0&&null!==g;)e=c.currentNode,f=e.nodeValue,f.length>b?(g=e.splitText(f.length-b),b=0):(g=c.previousNode(),b-=f.length);return g},performLinkingWithinElement:function(a){for(var c=this.findLinkableText(a),d=!1,e=0;e<c.length;e++){var f=b.findOrCreateMatchingTextNodes(this.document,a,c[e]);this.shouldNotLink(f)||this.createAutoLink(f,c[e].href)}return d},shouldNotLink:function(a){for(var c=!1,d=0;d<a.length&&c===!1;d++)c=!!b.traverseUp(a[d],function(a){return"a"===a.nodeName.toLowerCase()||a.getAttribute&&"true"===a.getAttribute("data-auto-link")});return c},findLinkableText:function(a){for(var b=new RegExp(o,"gi"),d=a.textContent,e=null,f=[];null!==(e=b.exec(d));){var g=!0,h=e.index+e[0].length;g=!(0!==e.index&&-1===m.indexOf(d[e.index-1])||h!==d.length&&-1===m.indexOf(d[h])),g=g&&(-1!==e[0].indexOf("/")||c.test(e[0].split(".").pop().split("?").shift())),g&&f.push({href:e[0],start:e.index,end:h})}return f},createAutoLink:function(a,c){c=b.ensureUrlHasProtocol(c);var d=b.createLink(this.document,a,c,this.getEditorOption("targetBlank")?"_blank":null),e=this.document.createElement("span");for(e.setAttribute("data-auto-link","true"),e.setAttribute("data-href",c),d.insertBefore(e,d.firstChild);d.childNodes.length>1;)e.appendChild(d.childNodes[1])}})}();var p;!function(){function a(a){var d=b.getContainerEditorElement(a),e=Array.prototype.slice.call(d.parentElement.querySelectorAll("."+c));e.forEach(function(a){a.classList.remove(c)})}var c="medium-editor-dragover";p=e.extend({name:"fileDragging",allowedTypes:["image"],init:function(){e.prototype.init.apply(this,arguments),this.subscribe("editableDrag",this.handleDrag.bind(this)),this.subscribe("editableDrop",this.handleDrop.bind(this))},handleDrag:function(b){b.preventDefault(),b.dataTransfer.dropEffect="copy";var d=b.target.classList?b.target:b.target.parentElement;a(d),"dragover"===b.type&&d.classList.add(c)},handleDrop:function(b){b.preventDefault(),b.stopPropagation(),b.dataTransfer.files&&Array.prototype.slice.call(b.dataTransfer.files).forEach(function(a){this.isAllowedFile(a)&&a.type.match("image")&&this.insertImageFile(a)},this),a(b.target)},isAllowedFile:function(a){return this.allowedTypes.some(function(b){return!!a.type.match(b)})},insertImageFile:function(a){var c=new FileReader;c.readAsDataURL(a);var d="medium-img-"+ +new Date;b.insertHTMLCommand(this.document,'<img class="medium-editor-image-loading" id="'+d+'" />'),c.onload=function(){var a=this.document.getElementById(d);a&&(a.removeAttribute("id"),a.removeAttribute("class"),a.src=c.result)}.bind(this)}})}();var q;!function(){q=e.extend({name:"keyboard-commands",commands:[{command:"bold",key:"B",meta:!0,shift:!1,alt:!1},{command:"italic",key:"I",meta:!0,shift:!1,alt:!1},{command:"underline",key:"U",meta:!0,shift:!1,alt:!1}],init:function(){e.prototype.init.apply(this,arguments),this.subscribe("editableKeydown",this.handleKeydown.bind(this)),this.keys={},this.commands.forEach(function(a){var b=a.key.charCodeAt(0);this.keys[b]||(this.keys[b]=[]),this.keys[b].push(a)},this)},handleKeydown:function(a){var c=b.getKeyCode(a);if(this.keys[c]){var d=b.isMetaCtrlKey(a),e=!!a.shiftKey,f=!!a.altKey;this.keys[c].forEach(function(b){b.meta===d&&b.shift===e&&b.alt===f&&(a.preventDefault(),a.stopPropagation(),!1!==b.command&&this.execAction(b.command))},this)}}})}();var r;!function(){r=i.extend({name:"fontsize",action:"fontSize",aria:"increase/decrease font size",contentDefault:"&#xB1;",contentFA:'<i class="fa fa-text-height"></i>',init:function(){i.prototype.init.apply(this,arguments)},handleClick:function(a){if(a.preventDefault(),a.stopPropagation(),!this.isDisplayed()){var b=this.document.queryCommandValue("fontSize")+"";this.showForm(b)}return!1},getForm:function(){return this.form||(this.form=this.createForm()),this.form},isDisplayed:function(){return"block"===this.getForm().style.display},hideForm:function(){this.getForm().style.display="none",this.getInput().value=""},showForm:function(a){var b=this.getInput();this.base.saveSelection(),this.hideToolbarDefaultActions(),this.getForm().style.display="block",this.setToolbarPosition(),b.value=a||"",b.focus()},destroy:function(){return this.form?(this.form.parentNode&&this.form.parentNode.removeChild(this.form),void delete this.form):!1},doFormSave:function(){this.base.restoreSelection(),this.base.checkSelection()},doFormCancel:function(){this.base.restoreSelection(),this.clearFontSize(),this.base.checkSelection()},createForm:function(){var a=this.document,b=a.createElement("div"),c=a.createElement("input"),d=a.createElement("a"),e=a.createElement("a");return b.className="medium-editor-toolbar-form",b.id="medium-editor-toolbar-form-fontsize-"+this.getEditorId(),this.on(b,"click",this.handleFormClick.bind(this)),c.setAttribute("type","range"),c.setAttribute("min","1"),c.setAttribute("max","7"),c.className="medium-editor-toolbar-input",b.appendChild(c),this.on(c,"change",this.handleSliderChange.bind(this)),e.setAttribute("href","#"),e.className="medium-editor-toobar-save",e.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-check"></i>':"&#10003;",b.appendChild(e),this.on(e,"click",this.handleSaveClick.bind(this),!0),d.setAttribute("href","#"),d.className="medium-editor-toobar-close",d.innerHTML="fontawesome"===this.getEditorOption("buttonLabels")?'<i class="fa fa-times"></i>':"&times;",b.appendChild(d),this.on(d,"click",this.handleCloseClick.bind(this)),b},getInput:function(){return this.getForm().querySelector("input.medium-editor-toolbar-input")},clearFontSize:function(){f.getSelectedElements(this.document).forEach(function(a){"font"===a.nodeName.toLowerCase()&&a.hasAttribute("size")&&a.removeAttribute("size")})},handleSliderChange:function(){var a=this.getInput().value;"4"===a?this.clearFontSize():this.execAction("fontSize",{size:a})},handleFormClick:function(a){a.stopPropagation()},handleSaveClick:function(a){a.preventDefault(),this.doFormSave()},handleCloseClick:function(a){a.preventDefault(),this.doFormCancel()}})}();var s;!function(){function a(){return[[new RegExp(/<[^>]*docs-internal-guid[^>]*>/gi),""],[new RegExp(/<\/b>(<br[^>]*>)?$/gi),""],[new RegExp(/<span class="Apple-converted-space">\s+<\/span>/g)," "],[new RegExp(/<br class="Apple-interchange-newline">/g),"<br>"],[new RegExp(/<span[^>]*(font-style:italic;font-weight:bold|font-weight:bold;font-style:italic)[^>]*>/gi),'<span class="replace-with italic bold">'],[new RegExp(/<span[^>]*font-style:italic[^>]*>/gi),'<span class="replace-with italic">'],[new RegExp(/<span[^>]*font-weight:bold[^>]*>/gi),'<span class="replace-with bold">'],[new RegExp(/&lt;(\/?)(i|b|a)&gt;/gi),"<$1$2>"],[new RegExp(/&lt;a(?:(?!href).)+href=(?:&quot;|&rdquo;|&ldquo;|"|“|”)(((?!&quot;|&rdquo;|&ldquo;|"|“|”).)*)(?:&quot;|&rdquo;|&ldquo;|"|“|”)(?:(?!&gt;).)*&gt;/gi),'<a href="$1">'],[new RegExp(/<\/p>\n+/gi),"</p>"],[new RegExp(/\n+<p/gi),"<p"],[new RegExp(/<\/?o:[a-z]*>/gi),""],["<!--EndFragment-->",""],["<!--StartFragment-->",""]]}s=e.extend({forcePlainText:!0,cleanPastedHTML:!1,cleanReplacements:[],cleanAttrs:["class","style","dir"],cleanTags:["meta"],init:function(){e.prototype.init.apply(this,arguments),(this.forcePlainText||this.cleanPastedHTML)&&this.subscribe("editablePaste",this.handlePaste.bind(this))},handlePaste:function(a,c){var d,e,f,g,h="",i="text/html",j="text/plain";if(this.window.clipboardData&&void 0===a.clipboardData&&(a.clipboardData=this.window.clipboardData,i="Text",j="Text"),a.clipboardData&&a.clipboardData.getData&&!a.defaultPrevented){if(a.preventDefault(),f=a.clipboardData.getData(i),g=a.clipboardData.getData(j),this.cleanPastedHTML&&f)return this.cleanPaste(f);if(this.getEditorOption("disableReturn")||c.getAttribute("data-disable-return"))h=b.htmlEntities(g);else if(d=g.split(/[\r\n]+/g),d.length>1)for(e=0;e<d.length;e+=1)""!==d[e]&&(h+="<p>"+b.htmlEntities(d[e])+"</p>");else h=b.htmlEntities(d[0]);b.insertHTMLCommand(this.document,h)}},cleanPaste:function(b){var c,d,e=/<p|<br|<div/.test(b),f=a().concat(this.cleanReplacements||[]);for(c=0;c<f.length;c+=1)b=b.replace(f[c][0],f[c][1]);return e?(d=b.split("<br><br>"),void this.pasteHTML("<p>"+d.join("</p><p>")+"</p>")):this.pasteHTML(b)},pasteHTML:function(a,c){c=b.defaults({},c,{cleanAttrs:this.cleanAttrs,cleanTags:this.cleanTags});var d,e,f,g,h=this.document.createDocumentFragment();for(h.appendChild(this.document.createElement("body")),g=h.querySelector("body"),g.innerHTML=a,this.cleanupSpans(g),d=g.querySelectorAll("*"),f=0;f<d.length;f+=1)e=d[f],"a"===e.nodeName.toLowerCase()&&this.getEditorOption("targetBlank")&&b.setTargetBlank(e),b.cleanupAttrs(e,c.cleanAttrs),b.cleanupTags(e,c.cleanTags);for(d=g.querySelectorAll("a,p,div,br"),f=0;f<d.length;f+=1)switch(e=d[f],e.innerHTML=e.innerHTML.replace(/\n/gi," "),e.nodeName.toLowerCase()){case"p":case"div":this.filterCommonBlocks(e);break;case"br":this.filterLineBreak(e)}b.insertHTMLCommand(this.document,g.innerHTML.replace(/&nbsp;/g," "))},isCommonBlock:function(a){return a&&("p"===a.nodeName.toLowerCase()||"div"===a.nodeName.toLowerCase())},filterCommonBlocks:function(a){/^\s*$/.test(a.textContent)&&a.parentNode&&a.parentNode.removeChild(a)},filterLineBreak:function(a){this.isCommonBlock(a.previousElementSibling)?this.removeWithParent(a):!this.isCommonBlock(a.parentNode)||a.parentNode.firstChild!==a&&a.parentNode.lastChild!==a?a.parentNode&&1===a.parentNode.childElementCount&&""===a.parentNode.textContent&&this.removeWithParent(a):this.removeWithParent(a)},removeWithParent:function(a){a&&a.parentNode&&(a.parentNode.parentNode&&1===a.parentNode.childElementCount?a.parentNode.parentNode.removeChild(a.parentNode):a.parentNode.removeChild(a))},cleanupSpans:function(a){var c,d,e,f=a.querySelectorAll(".replace-with"),g=function(a){return a&&"#text"!==a.nodeName&&"false"===a.getAttribute("contenteditable")};for(c=0;c<f.length;c+=1)d=f[c],e=this.document.createElement(d.classList.contains("bold")?"b":"i"),d.classList.contains("bold")&&d.classList.contains("italic")?e.innerHTML="<i>"+d.innerHTML+"</i>":e.innerHTML=d.innerHTML,d.parentNode.replaceChild(e,d);for(f=a.querySelectorAll("span"),c=0;c<f.length;c+=1){if(d=f[c],b.traverseUp(d,g))return!1;b.unwrap(d,this.document)}}})}();var t;!function(){t=e.extend({name:"placeholder",text:"Type your text",hideOnClick:!0,init:function(){e.prototype.init.apply(this,arguments),this.initPlaceholders(),this.attachEventHandlers()},initPlaceholders:function(){this.getEditorElements().forEach(function(a){a.getAttribute("data-placeholder")||a.setAttribute("data-placeholder",this.text),this.updatePlaceholder(a)},this)},destroy:function(){this.getEditorElements().forEach(function(a){a.getAttribute("data-placeholder")===this.text&&a.removeAttribute("data-placeholder")},this)},showPlaceholder:function(a){a&&a.classList.add("medium-editor-placeholder")},hidePlaceholder:function(a){a&&a.classList.remove("medium-editor-placeholder")},updatePlaceholder:function(a){return a.querySelector("img, blockquote, ul, ol")||""!==a.textContent.replace(/^\s+|\s+$/g,"")?void this.hidePlaceholder(a):this.showPlaceholder(a)},attachEventHandlers:function(){this.subscribe("blur",this.handleExternalInteraction.bind(this)),this.subscribe("editableBlur",this.handleBlur.bind(this)),this.hideOnClick?this.subscribe("editableClick",this.handleHidePlaceholderEvent.bind(this)):this.subscribe("editableKeyup",this.handleBlur.bind(this)),this.subscribe("editableKeypress",this.handleHidePlaceholderEvent.bind(this)),this.subscribe("editablePaste",this.handleHidePlaceholderEvent.bind(this))},handleHidePlaceholderEvent:function(a,b){this.hidePlaceholder(b)},handleBlur:function(a,b){this.updatePlaceholder(b)},handleExternalInteraction:function(){this.initPlaceholders()}})}();var u;!function(){u=e.extend({name:"toolbar",align:"center",allowMultiParagraphSelection:!0,buttons:["bold","italic","underline","anchor","h2","h3","quote"],diffLeft:0,diffTop:-10,firstButtonClass:"medium-editor-button-first",lastButtonClass:"medium-editor-button-last",standardizeSelectionStart:!1,"static":!1,sticky:!1,updateOnEmptySelection:!1,init:function(){e.prototype.init.apply(this,arguments),this.initThrottledMethods(),this.getEditorOption("elementsContainer").appendChild(this.getToolbarElement())},forEachExtension:function(a,b){return this.base.extensions.forEach(function(c){return c!==this?a.apply(b||this,arguments):void 0},this)},createToolbar:function(){var a=this.document.createElement("div");return a.id="medium-editor-toolbar-"+this.getEditorId(),a.className="medium-editor-toolbar",this["static"]?a.className+=" static-toolbar":a.className+=" medium-editor-stalker-toolbar",a.appendChild(this.createToolbarButtons()),this.forEachExtension(function(b){b.hasForm&&a.appendChild(b.getForm())}),this.attachEventHandlers(),a},createToolbarButtons:function(){var a,c,d,e,f,g,h=this.document.createElement("ul");return h.id="medium-editor-toolbar-actions"+this.getEditorId(),h.className="medium-editor-toolbar-actions",h.style.display="block",this.buttons.forEach(function(d){"string"==typeof d?(f=d,g=null):(f=d.name,g=d),e=this.base.addBuiltInExtension(f,g),e&&"function"==typeof e.getButton&&(c=e.getButton(this.base),a=this.document.createElement("li"),b.isElement(c)?a.appendChild(c):a.innerHTML=c,h.appendChild(a))},this),d=h.querySelectorAll("button"),d.length>0&&(d[0].classList.add(this.firstButtonClass),d[d.length-1].classList.add(this.lastButtonClass)),h},destroy:function(){this.toolbar&&(this.toolbar.parentNode&&this.toolbar.parentNode.removeChild(this.toolbar),delete this.toolbar)},getToolbarElement:function(){return this.toolbar||(this.toolbar=this.createToolbar()),this.toolbar},getToolbarActionsElement:function(){return this.getToolbarElement().querySelector(".medium-editor-toolbar-actions")},initThrottledMethods:function(){this.throttledPositionToolbar=b.throttle(function(){this.base.isActive&&this.positionToolbarIfShown()}.bind(this))},attachEventHandlers:function(){this.subscribe("blur",this.handleBlur.bind(this)),this.subscribe("focus",this.handleFocus.bind(this)),this.subscribe("editableClick",this.handleEditableClick.bind(this)),this.subscribe("editableKeyup",this.handleEditableKeyup.bind(this)),this.on(this.document.documentElement,"mouseup",this.handleDocumentMouseup.bind(this)),this["static"]&&this.sticky&&this.on(this.window,"scroll",this.handleWindowScroll.bind(this),!0),this.on(this.window,"resize",this.handleWindowResize.bind(this))},handleWindowScroll:function(){this.positionToolbarIfShown()},handleWindowResize:function(){this.throttledPositionToolbar()},handleDocumentMouseup:function(a){return a&&a.target&&b.isDescendant(this.getToolbarElement(),a.target)?!1:void this.checkState()},handleEditableClick:function(){setTimeout(function(){this.checkState()}.bind(this),0)},handleEditableKeyup:function(){this.checkState()},handleBlur:function(){clearTimeout(this.hideTimeout),clearTimeout(this.delayShowTimeout),this.hideTimeout=setTimeout(function(){this.hideToolbar()}.bind(this),1)},handleFocus:function(){this.checkState()},isDisplayed:function(){return this.getToolbarElement().classList.contains("medium-editor-toolbar-active")},showToolbar:function(){clearTimeout(this.hideTimeout),this.isDisplayed()||(this.getToolbarElement().classList.add("medium-editor-toolbar-active"),this.trigger("showToolbar",{},this.base.getFocusedElement()))},hideToolbar:function(){this.isDisplayed()&&(this.getToolbarElement().classList.remove("medium-editor-toolbar-active"),this.trigger("hideToolbar",{},this.base.getFocusedElement()))},isToolbarDefaultActionsDisplayed:function(){return"block"===this.getToolbarActionsElement().style.display},hideToolbarDefaultActions:function(){this.isToolbarDefaultActionsDisplayed()&&(this.getToolbarActionsElement().style.display="none")},showToolbarDefaultActions:function(){this.hideExtensionForms(),this.isToolbarDefaultActionsDisplayed()||(this.getToolbarActionsElement().style.display="block"),this.delayShowTimeout=this.base.delay(function(){this.showToolbar()}.bind(this))},hideExtensionForms:function(){this.forEachExtension(function(a){a.hasForm&&a.isDisplayed()&&a.hideForm()})},multipleBlockElementsSelected:function(){var a=/<[^\/>][^>]*><\/[^>]+>/gim,c=new RegExp("<("+b.blockContainerElementNames.join("|")+")[^>]*>","g"),d=f.getSelectionHtml(this.document).replace(a,""),e=d.match(c);return!!e&&e.length>1},modifySelection:function(){var a=this.window.getSelection(),c=a.getRangeAt(0);if(this.standardizeSelectionStart&&c.startContainer.nodeValue&&c.startOffset===c.startContainer.nodeValue.length){var d=b.findAdjacentTextNodeWithContent(f.getSelectionElement(this.window),c.startContainer,this.document);if(d){for(var e=0;0===d.nodeValue.substr(e,1).trim().length;)e+=1;c=f.select(this.document,d,e,c.endContainer,c.endOffset)}}},checkState:function(){if(!this.base.preventSelectionUpdates){if(!this.base.getFocusedElement()||f.selectionInContentEditableFalse(this.window))return this.hideToolbar();var a=f.getSelectionElement(this.window);return!a||-1===this.getEditorElements().indexOf(a)||a.getAttribute("data-disable-toolbar")?this.hideToolbar():this.updateOnEmptySelection&&this["static"]?this.showAndUpdateToolbar():""===this.window.getSelection().toString().trim()||this.allowMultiParagraphSelection===!1&&this.multipleBlockElementsSelected()?this.hideToolbar():void this.showAndUpdateToolbar();

}},showAndUpdateToolbar:function(){this.modifySelection(),this.setToolbarButtonStates(),this.trigger("positionToolbar",{},this.base.getFocusedElement()),this.showToolbarDefaultActions(),this.setToolbarPosition()},setToolbarButtonStates:function(){this.forEachExtension(function(a){"function"==typeof a.isActive&&"function"==typeof a.setInactive&&a.setInactive()}),this.checkActiveButtons()},checkActiveButtons:function(){var a,c=[],d=null,e=f.getSelectionRange(this.document),g=function(b){"function"==typeof b.checkState?b.checkState(a):"function"==typeof b.isActive&&"function"==typeof b.isAlreadyApplied&&"function"==typeof b.setActive&&!b.isActive()&&b.isAlreadyApplied(a)&&b.setActive()};if(e&&(this.forEachExtension(function(a){return"function"==typeof a.queryCommandState&&(d=a.queryCommandState(),null!==d)?void(d&&"function"==typeof a.setActive&&a.setActive()):void c.push(a)}),a=f.getSelectedParentElement(e),this.getEditorElements().some(function(c){return b.isDescendant(c,a,!0)})))for(;a&&(c.forEach(g),!b.isMediumEditorElement(a));)a=a.parentNode},positionToolbarIfShown:function(){this.isDisplayed()&&this.setToolbarPosition()},setToolbarPosition:function(){var a,b=this.base.getFocusedElement(),c=this.window.getSelection();return b?(this["static"]?(this.showToolbar(),this.positionStaticToolbar(b)):c.isCollapsed||(this.showToolbar(),this.positionToolbar(c)),a=this.base.getExtensionByName("anchor-preview"),void(a&&"function"==typeof a.hidePreview&&a.hidePreview())):this},positionStaticToolbar:function(a){this.getToolbarElement().style.left="0";var b,c=this.document.documentElement&&this.document.documentElement.scrollTop||this.document.body.scrollTop,d=this.window.innerWidth,e=this.getToolbarElement(),f=a.getBoundingClientRect(),g=f.top+c,h=f.left+f.width/2,i=e.offsetHeight,j=e.offsetWidth,k=j/2;switch(this.sticky?c>g+a.offsetHeight-i?(e.style.top=g+a.offsetHeight-i+"px",e.classList.remove("medium-editor-sticky-toolbar")):c>g-i?(e.classList.add("medium-editor-sticky-toolbar"),e.style.top="0px"):(e.classList.remove("medium-editor-sticky-toolbar"),e.style.top=g-i+"px"):e.style.top=g-i+"px",this.align){case"left":b=f.left;break;case"right":b=f.right-j;break;case"center":b=h-k}0>b?b=0:b+j>d&&(b=d-Math.ceil(j)-1),e.style.left=b+"px"},positionToolbar:function(a){this.getToolbarElement().style.left="0";var b=this.window.innerWidth,c=a.getRangeAt(0),d=c.getBoundingClientRect(),e=(d.left+d.right)/2,f=this.getToolbarElement(),g=f.offsetHeight,h=f.offsetWidth,i=h/2,j=50,k=this.diffLeft-i;d.top<j?(f.classList.add("medium-toolbar-arrow-over"),f.classList.remove("medium-toolbar-arrow-under"),f.style.top=j+d.bottom-this.diffTop+this.window.pageYOffset-g+"px"):(f.classList.add("medium-toolbar-arrow-under"),f.classList.remove("medium-toolbar-arrow-over"),f.style.top=d.top+this.diffTop+this.window.pageYOffset-g+"px"),i>e?f.style.left=k+i+"px":i>b-e?f.style.left=b+k-i+"px":f.style.left=k+e+"px"}})}();var v;!function(){v=e.extend({init:function(){e.prototype.init.apply(this,arguments),this.subscribe("editableDrag",this.handleDrag.bind(this)),this.subscribe("editableDrop",this.handleDrop.bind(this))},handleDrag:function(a){var b="medium-editor-dragover";a.preventDefault(),a.dataTransfer.dropEffect="copy","dragover"===a.type?a.target.classList.add(b):"dragleave"===a.type&&a.target.classList.remove(b)},handleDrop:function(a){var c,d="medium-editor-dragover";a.preventDefault(),a.stopPropagation(),a.dataTransfer.files&&(c=Array.prototype.slice.call(a.dataTransfer.files,0),c.some(function(a){if(a.type.match("image")){var c,d;c=new FileReader,c.readAsDataURL(a),d="medium-img-"+ +new Date,b.insertHTMLCommand(this.document,'<img class="medium-editor-image-loading" id="'+d+'" />'),c.onload=function(){var a=this.document.getElementById(d);a&&(a.removeAttribute("id"),a.removeAttribute("class"),a.src=c.result)}.bind(this)}}.bind(this))),a.target.classList.remove(d)}})}();var w;return function(){w={button:h,form:i,anchor:j,anchorPreview:k,autoLink:l,fileDragging:p,fontSize:r,imageDragging:v,keyboardCommands:q,paste:s,placeholder:t,toolbar:u}}(),function(){function c(a,b){if(this.options.disableReturn||b.getAttribute("data-disable-return"))a.preventDefault();else if(this.options.disableDoubleReturn||b.getAttribute("data-disable-double-return")){var c=f.getSelectionStart(this.options.ownerDocument);(c&&""===c.textContent.trim()||c.previousElementSibling&&""===c.previousElementSibling.textContent.trim())&&a.preventDefault()}}function h(a){var c=f.getSelectionStart(this.options.ownerDocument),d=c&&c.nodeName.toLowerCase();"pre"===d&&(a.preventDefault(),b.insertHTMLCommand(this.options.ownerDocument,"    ")),b.isListItem(c)&&(a.preventDefault(),a.shiftKey?this.options.ownerDocument.execCommand("outdent",!1,null):this.options.ownerDocument.execCommand("indent",!1,null))}function i(a){var c,d=f.getSelectionStart(this.options.ownerDocument),e=d.nodeName.toLowerCase(),g=/^(\s+|<br\/?>)?$/i,h=/h\d/i;b.isKey(a,[b.keyCode.BACKSPACE,b.keyCode.ENTER])&&d.previousElementSibling&&h.test(e)&&0===f.getCaretOffsets(d).left?b.isKey(a,b.keyCode.BACKSPACE)&&g.test(d.previousElementSibling.innerHTML)?(d.previousElementSibling.parentNode.removeChild(d.previousElementSibling),a.preventDefault()):b.isKey(a,b.keyCode.ENTER)&&(c=this.options.ownerDocument.createElement("p"),c.innerHTML="<br>",d.previousElementSibling.parentNode.insertBefore(c,d),a.preventDefault()):b.isKey(a,b.keyCode.DELETE)&&d.nextElementSibling&&d.previousElementSibling&&!h.test(e)&&g.test(d.innerHTML)&&h.test(d.nextElementSibling.nodeName.toLowerCase())?(f.moveCursor(this.options.ownerDocument,d.nextElementSibling),d.previousElementSibling.parentNode.removeChild(d),a.preventDefault()):b.isKey(a,b.keyCode.BACKSPACE)&&"li"===e&&g.test(d.innerHTML)&&!d.previousElementSibling&&!d.parentElement.previousElementSibling&&d.nextElementSibling&&"li"===d.nextElementSibling.nodeName.toLowerCase()&&(c=this.options.ownerDocument.createElement("p"),c.innerHTML="<br>",d.parentElement.parentElement.insertBefore(c,d.parentElement),f.moveCursor(this.options.ownerDocument,c),d.parentElement.removeChild(d),a.preventDefault())}function j(a){var c,d=f.getSelectionStart(this.options.ownerDocument);d&&(b.isMediumEditorElement(d)&&0===d.children.length&&this.options.ownerDocument.execCommand("formatBlock",!1,"p"),b.isKey(a,b.keyCode.ENTER)&&!b.isListItem(d)&&(c=d.nodeName.toLowerCase(),"a"===c?this.options.ownerDocument.execCommand("unlink",!1,null):a.shiftKey||a.ctrlKey||/h\d/.test(c)||this.options.ownerDocument.execCommand("formatBlock",!1,"p")))}function k(a){a._mediumEditors||(a._mediumEditors=[null]),this.id||(this.id=a._mediumEditors.length),a._mediumEditors[this.id]=this}function l(a){a._mediumEditors&&a._mediumEditors[this.id]&&(a._mediumEditors[this.id]=null)}function m(a){a||(a=[]),"string"==typeof a&&(a=this.options.ownerDocument.querySelectorAll(a)),b.isElement(a)&&(a=[a]);var c=Array.prototype.slice.apply(a);this.elements=[],c.forEach(function(a,b){this.elements.push("textarea"===a.nodeName.toLowerCase()?x.call(this,a,b):a)},this)}function n(a,b){return Object.keys(b).forEach(function(c){void 0===a[c]&&(a[c]=b[c])}),a}function o(a,b,c){var d={window:c.options.contentWindow,document:c.options.ownerDocument,base:c};return a=n(a,d),"function"==typeof a.init&&a.init(),a.name||(a.name=b),a}function p(){return this.elements.every(function(a){return!!a.getAttribute("data-disable-toolbar")})?!1:this.options.toolbar!==!1}function q(){return p.call(this)?this.options.anchorPreview!==!1:!1}function r(){return this.options.placeholder!==!1}function s(){return this.options.autoLink!==!1}function t(){return this.options.imageDragging!==!1}function u(){return this.options.keyboardCommands!==!1}function v(){return!this.options.extensions.imageDragging}function x(a,b){var c=this.options.ownerDocument.createElement("div"),d="medium-editor-"+Date.now()+"-"+b,e=a.attributes;c.className=a.className,c.id=d,c.innerHTML=a.value,a.setAttribute("medium-editor-textarea-id",b);for(var f=0,g=e.length;g>f;f++)c.hasAttribute(e[f].nodeName)||c.setAttribute(e[f].nodeName,e[f].nodeValue);return a.classList.add("medium-editor-hidden"),a.parentNode.insertBefore(c,a),c}function y(){this.elements.forEach(function(a,b){this.options.disableEditing||a.getAttribute("data-disable-editing")||(a.setAttribute("contentEditable",!0),a.setAttribute("spellcheck",this.options.spellcheck)),a.setAttribute("data-medium-editor-element",!0),a.setAttribute("role","textbox"),a.setAttribute("aria-multiline",!0),a.setAttribute("medium-editor-index",b),a.hasAttribute("medium-editor-textarea-id")&&this.on(a,"input",function(a){var b=a.target,c=b.parentNode.querySelector('textarea[medium-editor-textarea-id="'+b.getAttribute("medium-editor-textarea-id")+'"]');c&&(c.value=this.serialize()[b.id].value)}.bind(this))},this)}function z(){var a;if(this.subscribe("editableKeydownTab",h.bind(this)),this.subscribe("editableKeydownDelete",i.bind(this)),this.subscribe("editableKeydownEnter",i.bind(this)),this.options.disableReturn||this.options.disableDoubleReturn)this.subscribe("editableKeydownEnter",c.bind(this));else for(a=0;a<this.elements.length;a+=1)if(this.elements[a].getAttribute("data-disable-return")||this.elements[a].getAttribute("data-disable-double-return")){this.subscribe("editableKeydownEnter",c.bind(this));break}this.options.disableReturn||this.elements.forEach(function(a){a.getAttribute("data-disable-return")||this.on(a,"keyup",j.bind(this))},this)}function A(){if(this.extensions=[],Object.keys(this.options.extensions).forEach(function(a){"toolbar"!==a&&this.options.extensions[a]&&this.extensions.push(o(this.options.extensions[a],a,this))},this),v.call(this)){var c=this.options.fileDragging;c||(c={},t.call(this)||(c.allowedTypes=[])),this.addBuiltInExtension("fileDragging",c)}var d={paste:!0,"anchor-preview":q.call(this),autoLink:s.call(this),keyboardCommands:u.call(this),placeholder:r.call(this)};Object.keys(d).forEach(function(a){d[a]&&this.addBuiltInExtension(a)},this);var e=this.options.extensions.toolbar;if(!e&&p.call(this)){var f=b.extend({},this.options.toolbar,{allowMultiParagraphSelection:this.options.allowMultiParagraphSelection});e=new a.extensions.toolbar(f)}e&&this.extensions.push(o(e,"toolbar",this))}function B(a,c){var d=[["allowMultiParagraphSelection","toolbar.allowMultiParagraphSelection"]];return c&&d.forEach(function(a){c.hasOwnProperty(a[0])&&void 0!==c[a[0]]&&b.deprecated(a[0],a[1],"v6.0.0")}),b.defaults({},c,a)}function C(a,c){var d,e=/^append-(.+)$/gi,g=/justify([A-Za-z]*)$/g;if(d=e.exec(a))return b.execFormatBlock(this.options.ownerDocument,d[1]);if("fontSize"===a)return this.options.ownerDocument.execCommand("fontSize",!1,c.size);if("createLink"===a)return this.createLink(c);if("image"===a)return this.options.ownerDocument.execCommand("insertImage",!1,this.options.contentWindow.getSelection());if(g.exec(a)){var h=this.options.ownerDocument.execCommand(a,!1,null),i=f.getSelectedParentElement(f.getSelectionRange(this.options.ownerDocument));return i&&D.call(this,b.getTopBlockContainer(i)),h}return this.options.ownerDocument.execCommand(a,!1,null)}function D(a){if(a){var c,d=Array.prototype.slice.call(a.childNodes).filter(function(a){var b="div"===a.nodeName.toLowerCase();return b&&!c&&(c=a.style.textAlign),b});d.length&&(this.saveSelection(),d.forEach(function(a){if(a.style.textAlign===c){var d=a.lastChild;if(d){b.unwrap(a,this.options.ownerDocument);var e=this.options.ownerDocument.createElement("BR");d.parentNode.insertBefore(e,d.nextSibling)}}},this),a.style.textAlign=c,this.restoreSelection())}}a.Extension=e,a.extensions=w,a.util=b,a.selection=f,a.prototype={defaults:d,init:function(a,b){return this.options=B.call(this,this.defaults,b),this.origElements=a,this.options.elementsContainer||(this.options.elementsContainer=this.options.ownerDocument.body),this.setup()},setup:function(){this.isActive||(m.call(this,this.origElements),0!==this.elements.length&&(this.isActive=!0,k.call(this,this.options.contentWindow),this.events=new g(this),y.call(this),A.call(this),z.call(this)))},destroy:function(){this.isActive&&(this.isActive=!1,this.extensions.forEach(function(a){"function"==typeof a.destroy&&a.destroy()},this),this.events.destroy(),this.elements.forEach(function(a){if(this.options.spellcheck&&(a.innerHTML=a.innerHTML),a.removeAttribute("contentEditable"),a.removeAttribute("spellcheck"),a.removeAttribute("data-medium-editor-element"),a.removeAttribute("role"),a.removeAttribute("aria-multiline"),a.removeAttribute("medium-editor-index"),a.hasAttribute("medium-editor-textarea-id")){var b=a.parentNode.querySelector('textarea[medium-editor-textarea-id="'+a.getAttribute("medium-editor-textarea-id")+'"]');b&&b.classList.remove("medium-editor-hidden"),a.parentNode&&a.parentNode.removeChild(a)}},this),this.elements=[],l.call(this,this.options.contentWindow))},on:function(a,b,c,d){this.events.attachDOMEvent(a,b,c,d)},off:function(a,b,c,d){this.events.detachDOMEvent(a,b,c,d)},subscribe:function(a,b){this.events.attachCustomEvent(a,b)},unsubscribe:function(a,b){this.events.detachCustomEvent(a,b)},trigger:function(a,b,c){this.events.triggerCustomEvent(a,b,c)},delay:function(a){var b=this;return setTimeout(function(){b.isActive&&a()},this.options.delay)},serialize:function(){var a,b,c={};for(a=0;a<this.elements.length;a+=1)b=""!==this.elements[a].id?this.elements[a].id:"element-"+a,c[b]={value:this.elements[a].innerHTML.trim()};return c},getExtensionByName:function(a){var b;return this.extensions&&this.extensions.length&&this.extensions.some(function(c){return c.name===a?(b=c,!0):!1}),b},addBuiltInExtension:function(c,d){var e,f=this.getExtensionByName(c);if(f)return f;switch(c){case"anchor":e=b.extend({},this.options.anchor,d),f=new a.extensions.anchor(e);break;case"anchor-preview":f=new a.extensions.anchorPreview(this.options.anchorPreview);break;case"autoLink":f=new a.extensions.autoLink;break;case"fileDragging":f=new a.extensions.fileDragging(d);break;case"fontsize":f=new a.extensions.fontSize(d);break;case"keyboardCommands":f=new a.extensions.keyboardCommands(this.options.keyboardCommands);break;case"paste":f=new a.extensions.paste(this.options.paste);break;case"placeholder":f=new a.extensions.placeholder(this.options.placeholder);break;default:a.extensions.button.isBuiltInButton(c)&&(d?(e=b.defaults({},d,a.extensions.button.prototype.defaults[c]),f=new a.extensions.button(e)):f=new a.extensions.button(c))}return f&&this.extensions.push(o(f,c,this)),f},stopSelectionUpdates:function(){this.preventSelectionUpdates=!0},startSelectionUpdates:function(){this.preventSelectionUpdates=!1},checkSelection:function(){var a=this.getExtensionByName("toolbar");return a&&a.checkState(),this},queryCommandState:function(a){var b,c=/^full-(.+)$/gi,d=null;b=c.exec(a),b&&(a=b[1]);try{d=this.options.ownerDocument.queryCommandState(a)}catch(e){d=null}return d},execAction:function(a,c){var d,e,f=/^full-(.+)$/gi;return d=f.exec(a),d?(this.saveSelection(),this.selectAllContents(),e=C.call(this,d[1],c),this.restoreSelection()):e=C.call(this,a,c),("insertunorderedlist"===a||"insertorderedlist"===a)&&b.cleanListDOM(this.options.ownerDocument,this.getSelectedParentElement()),this.checkSelection(),e},getSelectedParentElement:function(a){return void 0===a&&(a=this.options.contentWindow.getSelection().getRangeAt(0)),f.getSelectedParentElement(a)},selectAllContents:function(){var a=f.getSelectionElement(this.options.contentWindow);if(a){for(;1===a.children.length;)a=a.children[0];this.selectElement(a)}},selectElement:function(a){f.selectNode(a,this.options.ownerDocument);var b=f.getSelectionElement(this.options.contentWindow);b&&this.events.focusElement(b)},getFocusedElement:function(){var a;return this.elements.some(function(b){return!a&&b.getAttribute("data-medium-focused")&&(a=b),!!a},this),a},exportSelection:function(){var a=f.getSelectionElement(this.options.contentWindow),b=this.elements.indexOf(a),c=null;return b>=0&&(c=f.exportSelection(a,this.options.ownerDocument)),null!==c&&0!==b&&(c.editableElementIndex=b),c},saveSelection:function(){this.selectionState=this.exportSelection()},importSelection:function(a,b){if(a){var c=this.elements[a.editableElementIndex||0];f.importSelection(a,c,this.options.ownerDocument,b)}},restoreSelection:function(){this.importSelection(this.selectionState)},createLink:function(a){var c,d,e;try{if(this.events.disableCustomEvent("editableInput"),a.url&&a.url.trim().length>0){var g=this.options.contentWindow.getSelection();if(g){var h,i,j,k,l=g.getRangeAt(0),m=l.commonAncestorContainer;if(3===l.endContainer.nodeType&&3!==l.startContainer.nodeType&&0===l.startOffset&&l.startContainer.firstChild===l.endContainer&&(m=l.endContainer),i=b.getClosestBlockContainer(l.startContainer),j=b.getClosestBlockContainer(l.endContainer),3!==m.nodeType&&i===j){c=f.getSelectionElement(this.options.contentWindow);var n=i||c,o=this.options.ownerDocument.createDocumentFragment();this.execAction("unlink"),h=this.exportSelection(),o.appendChild(n.cloneNode(!0)),c===n?f.select(this.options.ownerDocument,n.firstChild,0,n.lastChild,3===n.lastChild.nodeType?n.lastChild.nodeValue.length:n.lastChild.childNodes.length):f.select(this.options.ownerDocument,n,0,n,n.childNodes.length);var p=this.exportSelection();k=b.findOrCreateMatchingTextNodes(this.options.ownerDocument,o,{start:h.start-p.start,end:h.end-p.start,editableElementIndex:h.editableElementIndex}),b.createLink(this.options.ownerDocument,k,a.url.trim());var q=(o.firstChild.innerHTML.match(/^\s+/)||[""])[0].length;b.insertHTMLCommand(this.options.ownerDocument,o.firstChild.innerHTML.replace(/^\s+/,"")),h.start-=q,h.end-=q,this.importSelection(h)}else this.options.ownerDocument.execCommand("createLink",!1,a.url);(this.options.targetBlank||"_blank"===a.target)&&b.setTargetBlank(f.getSelectionStart(this.options.ownerDocument),a.url),a.buttonClass&&b.addClassToAnchors(f.getSelectionStart(this.options.ownerDocument),a.buttonClass)}}if(this.options.targetBlank||"_blank"===a.target||a.buttonClass)for(d=this.options.ownerDocument.createEvent("HTMLEvents"),d.initEvent("input",!0,!0,this.options.contentWindow),e=0;e<this.elements.length;e+=1)this.elements[e].dispatchEvent(d)}finally{this.events.enableCustomEvent("editableInput")}this.events.triggerCustomEvent("editableInput",d,c)},cleanPaste:function(a){this.getExtensionByName("paste").cleanPaste(a)},pasteHTML:function(a,b){this.getExtensionByName("paste").pasteHTML(a,b)},setContent:function(a,b){if(b=b||0,this.elements[b]){var c=this.elements[b];c.innerHTML=a,this.events.updateInput(c,{target:c,currentTarget:c})}}}}(),a.parseVersionString=function(a){var b=a.split("-"),c=b[0].split("."),d=b.length>1?b[1]:"";return{major:parseInt(c[0],10),minor:parseInt(c[1],10),revision:parseInt(c[2],10),preRelease:d,toString:function(){return[c[0],c[1],c[2]].join(".")+(d?"-"+d:"")}}},a.version=a.parseVersionString.call(this,{version:"5.6.0"}.version),a}());
var EventManager=function(){function t(t,e,a,n){return"string"==typeof t&&"function"==typeof e&&(a=parseInt(a||10,10),s("actions",t,e,a,n)),f}function e(){var t=Array.prototype.slice.call(arguments),e=t.shift();return"string"==typeof e&&l("actions",e,t),f}function a(t,e){return"string"==typeof t&&r("actions",t,e),f}function n(t,e,a,n){return"string"==typeof t&&"function"==typeof e&&(a=parseInt(a||10,10),s("filters",t,e,a,n)),f}function o(){var t=Array.prototype.slice.call(arguments),e=t.shift();return"string"==typeof e?l("filters",e,t):f}function i(t,e){return"string"==typeof t&&r("filters",t,e),f}function r(t,e,a,n){if(d[t][e])if(a){var o,i=d[t][e];if(n)for(o=i.length;o--;){var r=i[o];r.callback===a&&r.context===n&&i.splice(o,1)}else for(o=i.length;o--;)i[o].callback===a&&i.splice(o,1)}else d[t][e]=[]}function s(t,e,a,n,o){var i={callback:a,priority:n,context:o},r=d[t][e];r?(r.push(i),r=c(r)):r=[i],d[t][e]=r}function c(t){for(var e,a,n,o=1,i=t.length;i>o;o++){for(e=t[o],a=o;(n=t[a-1])&&n.priority>e.priority;)t[a]=t[a-1],--a;t[a]=e}return t}function l(t,e,a){var n=d[t][e];if(!n)return"filters"===t?a[0]:!1;var o=0,i=n.length;if("filters"===t)for(;i>o;o++)a[0]=n[o].callback.apply(n[o].context,a);else for(;i>o;o++)n[o].callback.apply(n[o].context,a);return"filters"===t?a[0]:!0}var f={removeFilter:i,applyFilters:o,addFilter:n,removeAction:a,doAction:e,addAction:t},d={actions:{},filters:{}};return f};
function Wa_image_upload(t){this.editor_options=t,this.button=document.createElement("button"),this.button.className="medium-wa-image-upload-action",this.button.icon=document.createElement("i"),this.button.icon.className="fa fa-picture-o",this.button.appendChild(this.button.icon),this.button.onclick=this.onClick.bind(this),this.get_image_src_timeout=!1,document.body.appendChild(this.button)}Wa_image_upload.prototype.setup_wp_media=function(t,e,a){e=e||!1,a=a||!1;var n=this;if(this.frame){if(this.frame.options.state===t)return;this.frame.dispose()}if("insert"===t)this.frame=wp.media({frame:"post",editing:!0,multiple:!1});else if("gallery-edit"===t&&e!==!1){var o=this.select(e);o!==!1?this.frame=wp.media({frame:"post",state:"gallery-edit",title:wp.media.view.l10n.editGalleryTitle,editing:!0,multiple:!0,selection:o}):this.frame=wp.media({frame:"post",state:"gallery-edit",title:wp.media.view.l10n.editGalleryTitle,editing:!0,multiple:!0})}else"featured-image"===t&&(this.frame=wp.media({frame:"post",state:"featured-image",states:[new wp.media.controller.FeaturedImage,new wp.media.controller.EditImage]}));this.frame.on("insert",function(){var t=n.frame.state().get("selection");0===t.length?n.insertGallery(n.frame):"undefined"!=typeof n.replace_this&&n.replace_this!==!1?n.insertImage(n.frame,n.replace_this):n.insertImage(n.frame)}),this.frame.on("update",function(){n.insertGallery(n.frame,a)}),this.frame.state("featured-image").on("select",function(){n.frame.state().get("selection").single();"undefined"!=typeof n.replace_this&&n.replace_this!==!1?n.insertImage(n.frame,n.replace_this):n.insertImage(n.frame)})},Wa_image_upload.prototype.init=function(){this.setup_wp_media("insert"),this.instance=this.base,this.bindings(this.instance,jQuery(this.instance.elements))},Wa_image_upload.prototype.aspect_ratio=function(t,e){return t/e},Wa_image_upload.prototype.round=function(t,e){return Number(Math.round(t+"e"+e)+"e-"+e)},Wa_image_upload.prototype.get_closest_image_size=function(t,e,a,n){clearTimeout(this.get_image_src_timeout);var o=this,e=Math.round(e),a=Math.round(a),i=!1,r={diff:null,size_name:null,height:null,width:null,crop:null},s=this.round(this.aspect_ratio(a,e),2);i=e===a?"square":"original";for(size in global_vars.image_sizes){var c=global_vars.image_sizes[size],l=parseInt(c.height),f=parseInt(c.width),d=o.round(o.aspect_ratio(f,l),2),u=!1;if(u=l===f&&c.crop===!0?"square":"original",Math.abs(s-d)<3&&i===u){var p=Math.abs(e-l);(null===r.diff||p<r.diff)&&(r.diff=p,r.size_name=size,r.height=l,r.width=f,r.crop=c.crop)}}clearTimeout(this.get_image_src_timeout),this.get_image_src_timeout=setTimeout(function(){null!==r.size_name&&jQuery.post(global_vars.ajax_url,{action:"wa_get_image_src",attachment_id:t,size:r.size_name},function(t){n(t)})},1e3)},Wa_image_upload.prototype.bindings=function(t,e){var a=this;jQuery("body").click(function(t){jQuery(a.button).removeClass("show")}),e.on("resizecreate",function(t,e){var a=t.target.firstChild.className,n=a.match(/([align]\S+)/)[1];jQuery(t.target).css({overflow:"visible",margin:""}).addClass(n)}),a.enable_resizing(t,e),e.click(function(n){if(0!==jQuery(n.target).parents(".wa-shortcode-wrap").length){n.preventDefault();var o=jQuery(n.target).parents(".wa-shortcode-wrap");"gallery"===o.attr("data-shortcode-base")&&(a.setup_wp_media("gallery-edit",wa_fronted.shortcode_from_attr(o),o),a.frame.open())}else if(""===wa_fronted.getSelectionText()&&"IMG"!==n.target.tagName){n.preventDefault(),a.setup_wp_media("insert"),clearTimeout(i);var i=setTimeout(function(){a.showToolbar(n,e)},t.options.delay)}else if("IMG"===n.target.tagName){n.preventDefault();var r=jQuery(n.target),s=r.parents("a"),c=r;0!==s.length&&(c=s),a.replace_this=c;var l=n.target.className.match(/wp-image-\d+/);null!==l?(a.setup_wp_media("insert"),a.WPMedia(parseInt(l[0].match(/\d+/)[0]))):(a.setup_wp_media("featured-image"),wa_fronted.show_loading_spinner(),jQuery.post(global_vars.ajax_url,{action:"wa_get_thumbnail_id",post_id:a.editor_options.post_id},function(t){""!==t.attachment_id&&t.attachment_id!==!1&&(wp.media.view.settings.post.featuredImageId=parseInt(t.attachment_id),a.WPMedia(parseInt(t.attachment_id))),wa_fronted.hide_loading_spinner()}))}}),t.subscribe("editableDrag",function(t,e){console.log(e)}),t.subscribe("editableDrop",function(t,e){console.log(e)})},Wa_image_upload.prototype.enable_resizing=function(t,e){var a=this;e.find('img[class*="wp-image-"]').resizable({autoHide:!0,aspectRatio:!0,ghost:!0,handles:"nw, ne, sw, se",resize:function(e,n){var o=n.element.context.className.match(/wp-image-\d+/);if(null!==o){var i=o[0].match(/\d+/)[0];a.get_closest_image_size(i,n.size.height,n.size.width,function(t){if(t[3]===!0){var e=n.element.context.className.match(/size-\S+/),a=jQuery(n.element.context);null!==e&&a.removeClass(e[0]).addClass("size-"+t[4]),a.attr("src",t[0])}})}wa_fronted.trigger(t,"editableInput")}})},Wa_image_upload.prototype.select=function(t){var e,a,n=wp.shortcode.next("gallery",t),o=wp.media.gallery.defaults.id;return n?(n=n.shortcode,_.isUndefined(n.get("id"))&&!_.isUndefined(o)&&n.set("id",o),e=wp.media.gallery.attachments(n),a=new wp.media.model.Selection(e.models,{props:e.props.toJSON(),multiple:!0}),a.gallery=e.gallery,a.more().done(function(){a.props.set({query:!1}),a.unmirror(),a.props.unset("orderby")}),a):!1},Wa_image_upload.prototype.showToolbar=function(t,e){var a=this;a.positionImageToolbar(t),jQuery(a.button).addClass("show"),jQuery(window).scroll(function(){a.positionImageToolbar(t)})},Wa_image_upload.prototype.onClick=function(){this.WPMedia()},Wa_image_upload.prototype.insertGallery=function(t,e){e=e||!1;var a=t.states.get("gallery-edit");if(library=a.get("library"),self=this,0!==library.length){var n=wp.media.gallery.shortcode(library).string();wa_fronted.shortcode_to_html(n,e===!1?!0:!1,function(t){e!==!1?wa_fronted.replace_html(e,t):wa_fronted.insertHtmlAtCaret(t),wa_fronted.trigger(self.instance,"editableInput")})}},Wa_image_upload.prototype.insertImage=function(t,e){var a=this,n=t.state(),o=n.get("selection"),e=e||!1;o&&o.each(function(t){var o,i,r=n.display(t).toJSON(),s=t.toJSON(),c=s.caption;wp.media.view.settings.captions||delete s.caption,r=wp.media.string.props(r,s),o={id:s.id,post_content:s.description,post_excerpt:c},"featured-image"!==n.id?(r.linkUrl&&(o.url=r.linkUrl),"image"===s.type?(r.url=r.src,i=wp.media.string.image(r),_.each({align:"align",size:"image-size",alt:"image_alt"},function(t,e){r[e]&&(o[t]=r[e])})):"video"===s.type?i=wp.media.string.video(r,s):"audio"===s.type?i=wp.media.string.audio(r,s):(i=wp.media.string.link(r),o.post_title=r.title),t.attributes.nonce=wp.media.view.settings.nonce.sendToEditor,t.attributes.attachment=o,t.attributes.html=i,t.attributes.post_id=wp.media.view.settings.post.id,e!==!1?wp.media.view.settings.captions&&c?wa_fronted.shortcode_to_html(t.attributes.html,!0,function(t){wa_fronted.replace_html(e,t),a.replace_this=!1}):(wa_fronted.replace_html(e,t.attributes.html),a.replace_this=!1):wa_fronted.insertHtmlAtCaret(t.attributes.html),wa_fronted.trigger(a.instance,"editableInput"),a.enable_resizing(a.instance,jQuery(a.instance.elements))):(wa_fronted.show_loading_spinner(),jQuery.post(global_vars.ajax_url,{action:"wa_set_thumbnail",attachment_id:o.id,image_size:a.editor_options.image_size,post_id:a.editor_options.post_id},function(t){t.hasOwnProperty("html")&&e!==!1&&(wa_fronted.replace_html(e,t.html),a.replace_this=!1),wa_fronted.hide_loading_spinner()}))})},Wa_image_upload.prototype.WPMedia=function(t){t=t||!1;var e=this.frame;e.once("open",function(){var a=e.state().get("selection");t!==!1?(attachment=wp.media.attachment(t),attachment.fetch(),a.add(attachment)):a.reset()}),e.open()},Wa_image_upload.prototype.getButton=function(){return this.button},Wa_image_upload.prototype.positionImageToolbar=function(t){this.button.style.left="0";var e=this.base.options.contentWindow.innerWidth,a=this.button.offsetWidth,n=a/2,o=50,i=n,r=wa_fronted.getCaretPositionPx();r.y<o?(this.button.classList.add("medium-toolbar-arrow-over"),this.button.classList.remove("medium-toolbar-arrow-under"),this.button.style.top=r.y+(o-5)+"px"):(this.button.classList.add("medium-toolbar-arrow-under"),this.button.classList.remove("medium-toolbar-arrow-over"),this.button.style.top=r.y-(o-5)+"px"),r.x<n?this.button.style.left=i+n+"px":e-r.x<n?this.button.style.left=e+i-n+"px":this.button.style.left=r.x-n+"px"};
function escape_regexp(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var wa_fronted;!function(t){wa_fronted={options:t.parseJSON(global_vars.options),data:{editable_areas:[],timers:{},current_selection:!1,current_range:!1,current_editor_options:!1,has_changes:!1},add_action:function(){var t=arguments[0].split(" ");for(k in t)arguments[0]="wa_fronted."+t[k],wp.hooks.addAction.apply(this,arguments);return this},remove_action:function(){return arguments[0]="wa_fronted."+arguments[0],wp.hooks.removeAction.apply(this,arguments),this},do_action:function(){return arguments[0]="wa_fronted."+arguments[0],wp.hooks.doAction.apply(this,arguments),this},add_filter:function(){return arguments[0]="wa_fronted."+arguments[0],wp.hooks.addFilter.apply(this,arguments),this},remove_filter:function(){return arguments[0]="wa_fronted."+arguments[0],wp.hooks.removeFilter.apply(this,arguments),this},apply_filters:function(){return arguments[0]="wa_fronted."+arguments[0],wp.hooks.applyFilters.apply(this,arguments)},initialize:function(){var e=this;if(void 0!==typeof e.options.editable_areas&&0!==e.options.editable_areas.length){for(var a=0;a<e.options.editable_areas.length;a++){var n=t(e.options.editable_areas[a].container);0!==n.length&&t.each(n,function(n,o){o=t(o),o.addClass("wa-fronted-editor"),e.setup_editor(o,e.options.editable_areas[a],e.options),e.data.editable_areas.push({editor:o,options:e.options.editable_areas[a]})})}e.do_action("on_init"),e.bind()}},bind:function(){var e=this;t("#wa-fronted-save").click(function(){e.save()}),t("#wa-fronted-settings").click(function(){t("#wa-fronted-settings-modal").fadeIn("fast")}),t(".close-wa-fronted-modal").click(function(){t("#wa-fronted-settings-modal").fadeOut("fast")});var a=t(".wa_fronted_datepicker");a.datetimepicker({dateFormat:"yy-mm-dd",timeFormat:"HH:mm:ss"}),a.datetimepicker("setDate",a.val()),t("#wa-fronted-settings-modal select").selectmenu(),e.do_action("on_bind"),window.onbeforeunload=function(){return e.data.has_changes?"The changes you have made will be lost if you navigate away from this page.":void 0}},setup_editor:function(e,a,n){var o=this,i={buttons:["bold","italic","underline","anchor","header1","header2","quote","unorderedlist","orderedlist","justifyLeft","justifyCenter","justifyRight"],buttonLabels:"fontawesome",imageDragging:!1,autoLink:!0,anchorPreview:!1,anchor:{linkValidation:!0}};void 0===a.toolbar&&(a.toolbar="full"),"false"===a.toolbar||a.toolbar===!1?i.toolbar=!1:"full"!==a.toolbar&&(i.buttons=a.toolbar.replace(/\s+/g,"").split(",")),i.buttons=o.apply_filters("toolbar_buttons",i.buttons,a),e.click(function(){var e=window.getSelection();e&&(o.data.current_selection=t.extend({},e),e.rangeCount&&(o.data.current_range=e.getRangeAt(0)))});var r=!1;"only"!==a.media_upload&&a["native"]?(a.media_upload===!0&&(i.extensions={image_upload:new Wa_image_upload(a)}),i.extensions=o.apply_filters("medium_extensions",i.extensions,a),r=new MediumEditor(e,i),r.subscribe("editablePaste",function(a,n){a.preventDefault();var i=a.clipboardData.getData("text/plain");!i||-1===i.indexOf("http://")&&-1===i.indexOf("https://")||(o.show_loading_spinner(),t.post(global_vars.ajax_url,{action:"wa_get_oembed",link:i},function(t){if(t.oembed!==!1){var a=e.html(),n=escape_regexp(i),r=new RegExp(n,"m"),s=a.replace(r,t.oembed);e.html(s)}o.hide_loading_spinner()}))})):"only"===a.media_upload&&a["native"]?(i.toolbar=!1,i.spellcheck=!1,i.extensions={image_upload:new Wa_image_upload(a)},i.extensions=o.apply_filters("medium_extensions",i.extensions,a),r=new MediumEditor(e,i)):o.do_action("on_setup_editor",e,a,n),r!==!1&&r.subscribe("editableInput",function(t,n){clearTimeout(o.data.timers[r.id]),o.data.timers[r.id]=setTimeout(function(){o.data.has_changes=!0,o.auto_save(e,a),o.show_save_button()},1e3)})},trigger:function(t,e){t.events.customEvents[e][0]()},auto_save:function(t,e){console.log("auto save",t,e)},save:function(){var e=this,a=e.data.editable_areas,n=[];e.show_loading_spinner();for(var o=0;o<a.length;o++){var i=a[o].editor.attr("data-db-value"),r="";r="undefined"!=typeof i&&i!==!1?i:a[o].editor.html(),n.push({content:r,options:a[o].options})}t.post(global_vars.ajax_url,{action:"wa_fronted_save",data:n,wa_fronted_save_nonce:e.options.nonce},function(t){t.success&&location.reload(),e.hide_loading_spinner()})},show_save_button:function(){t("#wa-fronted-save").fadeIn("fast")},show_loading_spinner:function(){t("#wa-fronted-spinner").fadeIn("fast")},hide_loading_spinner:function(){t("#wa-fronted-spinner").fadeOut("fast")},shortcode_from_attr:function(t){return decodeURIComponent(t.attr("data-shortcode"))},shortcode_to_html:function(e,a,n){t.post(global_vars.ajax_url,{action:"wa_render_shortcode",shortcode:e,comments:a},function(t){n(t)})},getCaretPositionPx:function(){var t=0,e=0,a=window.getSelection();if(a.rangeCount){var n=a.getRangeAt(0),o="p"==n.startContainer.nodeName.toLowerCase()&&0==n.startOffset;if(o)t=n.startContainer.offsetLeft,e=n.startContainer.offsetTop;else if(n.getClientRects){var i=n.getClientRects();i.length>0&&(t=i[0].left,e=i[0].top)}}return{x:t,y:e}},getSelectionText:function(){var t="";return window.getSelection?t=window.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(t=document.selection.createRange().text),t},specific_output_to:function(e,a,n,o){if(!a.hasOwnProperty("output_to")||!a.output_to.hasOwnProperty("selector"))return!1;var i=t(e).find(a.output_to.selector);return 0===i.length?!1:(a.output_to.hasOwnProperty("attr")?i.attr(a.output_to.attr,o):i.html(o),e.attr("data-db-value",n),!0)},insertHtmlAtCaret:function(t){var e,a,n=this;if(window.getSelection){void 0===typeof n.data.current_selection||"undefined"==typeof n.data.current_selection||n.data.current_selection===!1?(e=window.getSelection(),a=e.getRangeAt(0)):(e=n.data.current_selection,a=n.data.current_range),"undefined"!=typeof a&&a!==!1&&a.deleteContents();var o=document.createElement("div");o.innerHTML=t;for(var i,r,s=document.createDocumentFragment();i=o.firstChild;)r=s.appendChild(i);a.insertNode(s),n.current_selection=!1}else document.selection&&"Control"!=document.selection.type&&document.selection.createRange().pasteHTML(t)},replace_html:function(e,a){el=t(e),el.replaceWith(a)}},t(document).ready(function(){"undefined"!=typeof global_vars.options&&Modernizr.contenteditable&&(window.wp=window.wp||{},"undefined"==typeof window.wp.hooks&&(window.wp.hooks=new EventManager),wa_fronted.initialize())})}(jQuery);
