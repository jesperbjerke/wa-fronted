<h1 id="wa-fronted-wordpress-plugin">WA Fronted WordPress Plugin</h1>
<p><a href="https://gitter.im/jesperbjerke/wa-fronted?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge"><img src="https://badges.gitter.im/Join%20Chat.svg" alt="Join the chat at https://gitter.im/jesperbjerke/wa-fronted"></a>
Discuss this project at Gitter</p>
<p>Frontend editor for WordPress, an experiment with a goal to enhance usability and convenience of editing exisiting content.</p>
<blockquote>
<p>This plugin is intended strictly for plugin and theme developers, it will <strong>not</strong> work &quot;out of the box&quot;. Are you an end-user? <a href="https://edituswp.com/">Look here!</a></p>
</blockquote>
<p><img src="https://github.com/jesperbjerke/wa-fronted/blob/master/screenshots/screenshot-1.jpg" alt="">
<img src="https://github.com/jesperbjerke/wa-fronted/blob/master/screenshots/screenshot-2.jpg" alt="">
<img src="https://github.com/jesperbjerke/wa-fronted/blob/master/screenshots/screenshot-3.jpg" alt=""></p>
<h2 id="configuration">Configuration</h2>
<p>To enable an editable area, simply add a filter function to <code>wa_fronted_options</code> that passes and returns a multidimensional array. Note that both themes and plugins can call this filter before or after eachother and build upon or replace options.</p>
<p>The first level of the array consists of the key <code>defaults</code> (optional) and <code>post_types</code>. In <code>defaults</code>, specify whatever you want to be set as default when you have not set anything else in that specific area. In <code>post_types</code> you create an array for each post type you want to enable frontend editing for (you can also use <code>front_page</code> if you just want to target your static front page). Inside, you set <code>editable_areas</code> with an array with options for each editable area on this post type.</p>
<p>The following example will enable the regular post content on front page to be editable from frontend if logged in user has role <code>administrator</code>, with a toolbar consisting of only bold and italic buttons, but on posts we allow a full toolbar and leaving permission to the default (<code>current_user_can(&#39;edit_posts&#39;)</code>).</p>
<pre><code class="lang-php">&lt;?php 
function my_editor_options($exisiting_options){
    //It is recommended to do an array_merge with the exisiting options to not break other settings
    return array_merge($exisiting_options, array(
        &quot;defaults&quot; =&gt; array(
            &quot;permission&quot;   =&gt; &quot;default&quot;,
            &quot;toolbar&quot;      =&gt; &quot;full&quot;,
            &quot;media_upload&quot; =&gt; true
        ),
        &quot;post_types&quot; =&gt; array(
            &quot;front_page&quot; =&gt; array(
                &quot;editable_areas&quot; =&gt; array(
                    array(
                        &quot;container&quot;  =&gt; &quot;.entry-content&quot;,
                        &quot;field_type&quot; =&gt; &quot;post_content&quot;,
                        &quot;toolbar&quot;    =&gt; &quot;bold, italic&quot;,
                        &quot;permission&quot; =&gt; &quot;administrator&quot;
                    )
                )
            ),
            &quot;post&quot; =&gt; array(
                &quot;editable_areas&quot; =&gt; array(
                    array(
                        &quot;container&quot;  =&gt; &quot;.entry-content&quot;,
                        &quot;field_type&quot; =&gt; &quot;post_content&quot;,
                        &quot;toolbar&quot;    =&gt; &quot;full&quot;
                    )
                )
            )
        )
    )); 
}
add_filter(&#39;wa_fronted_options&#39;, &#39;my_editor_options&#39;);
?&gt;
</code></pre>
<h2 id="options">Options</h2>
<ul>
<li><strong>native</strong> (optional, bool): <code>true</code> (default, setup the native editor), <code>false</code> (utilize the do_action function instead)</li>
<li><strong>direction</strong> (optional, string): <code>ltr</code> (default, left-to-right reading direction), <code>rtl</code> (right-to-left reading direction)</li>
<li><strong>container</strong> (required, string): selector of wrapping element of what you want to edit. Can be any valid jQuery selector string</li>
<li><strong>field_type</strong> (required, string): <code>post_content</code>, <code>post_title</code>, <code>post_thumbnail</code> (note that if you don&#39;t use the<em>post_thumbnail() function, the image has to have the class &#39;attachment-post-thumbnail&#39;), `acf</em>{FIELD ID}<code>/</code>acf<em>sub</em>{SUBFIELD ID}<code>(if set and **toolbar** is not specified, **toolbar** will set itself based on what field it is),</code>woo<em>{WooCommerce field (see supported fields below)}<code>,</code>meta</em>{custom field type (see supported fields below)}<code>,</code>option`</li>
<li><strong>permission</strong> (optional, string): <code>logged-in</code> (enable to all logged in users), <code>default</code> (default, enabled if user has capability <em>edit_posts</em>), <code>{USER ROLE}</code> (enable to specific user role)</li>
<li><strong>post_id</strong> (optional, int): Insert post id to override the <code>global $post</code> variable. If used in combination with <code>acf_{FIELD ID}</code>, note that it can also be set to <em>options / taxonomies / users / etc</em></li>
<li><strong>toolbar</strong> (optional, mixed bool/string): <code>full</code> (default, all buttons), <code>false</code> (do not show toolbar), <code>comma-separated string</code> (<code>bold</code>, <code>italic</code>, <code>underline</code>, <code>anchor</code>, <code>header1</code>, <code>header2</code>, <code>quote</code>, <code>unorderedlist</code>, <code>orderedlist</code>, <code>justifyLeft</code>, <code>justifyCenter</code>, <code>justifyRight</code>, <code>renderShortcode</code>)</li>
<li><strong>media_upload</strong> (optional, mixed bool/string): <code>true</code> (default, will allow user to insert/upload media to the editable area), <code>false</code> (disable media upload), <code>only</code> (constrain the editable area to only edit media. ie; no text, no toolbar)</li>
<li><strong>image_size</strong> (optional, string): any registered image size (only applicable if <strong>field_type</strong> is <code>post_thumbnail</code> and you want another image size than WP default, which is <code>post-thumbnail</code>)</li>
<li><strong>output</strong> (optional, string): alue to retrieve from <code>get_field()</code> to output as a dot separated string representing the traversing of value array, ie. for an image field that should output the thumbnail: <code>sizes.thumbnail</code> <em>(only applicable to ACF fields with complex output)</em></li>
<li><strong>output_to</strong> (optional, array): <em>if not specified, the returned data after save/selection will be put directly into the container element</em> can also be an multidimensional array with multiple &quot;selector&quot;/&quot;attr&quot; pairs<pre><code class="lang-php">array(
  &quot;selector&quot; =&gt; (string) selector of element inside **container** to output content to. Can be any valid jQuery selector string,
  &quot;attr&quot;    =&gt; (mixed bool/string) if output should be set to an attribute of **selector**, otherwise false or not set
)
</code></pre>
</li>
<li><strong>paragraphs</strong> (optional, bool): <code>true</code> (default, allow linebreaks/paragraphs when pressing the enter key), <code>false</code> (prevent enter key) </li>
<li><strong>validation</strong> (optional, mixed bool/array): <code>false</code> (default, do not validate)<pre><code class="lang-php">array(
  &quot;type&quot; =&gt; (string) validation type to check against, see validation types below,
  &quot;compare&quot; =&gt; (mixed) if needed, pass value to compare against
)
</code></pre>
</li>
<li><strong>meta_key</strong> (optional, string): if <strong>field_type</strong> is a custom field, set which meta_key to save to</li>
<li><strong>values</strong> (required if <strong>meta_key</strong> is <code>meta_select</code>, array): an array of arrays with values to populate the dropdown with<pre><code class="lang-php">array(
  array(
      &quot;label&quot;    =&gt; &quot;Yes&quot;, // (string) label to show for the value in the dropdown
      &quot;value&quot;    =&gt; true,  // (mixed) the value to store to database when selected and insert to page
      &quot;selected&quot; =&gt; true   // (bool) set wether this value should be pre-selected
  ),
  array(
      &quot;label&quot; =&gt; &quot;No&quot;,
      &quot;value&quot; =&gt; false
  )
)
</code></pre>
</li>
<li><strong>option_name</strong> (required if <strong>field_type</strong> is <code>option</code>, string): name of option_name to save to in wp_options table</li>
</ul>
<h4 id="validation-types">Validation types</h4>
<blockquote>
<p>Some validation types requires you to pass a comparison value. ACF field validation will be read from the field object</p>
</blockquote>
<ul>
<li><strong>not_blank</strong> (string is not empty or null)</li>
<li><strong>is_date</strong></li>
<li><strong>is_email</strong></li>
<li><strong>is_num</strong></li>
<li><strong>contains_num</strong></li>
<li><strong>is_alphanum</strong></li>
<li><strong>is_url</strong></li>
<li><strong>is_tel</strong> </li>
<li><strong>min_length</strong> (string length is greater)</li>
<li><strong>max_length</strong> (string length is less)</li>
<li><strong>is_length</strong> (string length equals)</li>
<li><strong>min</strong> (number is greater)</li>
<li><strong>max</strong> (number is less)</li>
<li><strong>between</strong> (number is between two array values)</li>
<li><strong>equal_to</strong> (number equals)</li>
</ul>
<h2 id="action-hooks">Action hooks</h2>
<h3 id="php">PHP</h3>
<ul>
<li><strong>wa_fronted_inited</strong> runs upon plugin initialization, before the options array has been set</li>
<li><strong>wa_fronted_after_init</strong> runs after the options array has been set (passes complete JSON encoded options as argument)</li>
<li><strong>wa_fronted_before_scripts</strong> runs before plugin has registered all its scripts and styles (passes complete JSON encoded options as argument)</li>
<li><strong>wa_fronted_after_scripts</strong> runs after plugin has registered all its scripts and styles (passes complete JSON encoded options as argument)</li>
<li><strong>wa_fronted_save</strong> runs after regular save function (passes $data as argument)</li>
<li><strong>wa_fronted_autosave</strong> runs after regular autosave function (passes $data as argument)</li>
<li><strong>wa_fronted_toolbar</strong> runs when bottom toolbar renders (before ending <code>&lt;/div&gt;</code>) (passes complete JSON encoded options as argument)</li>
<li><strong>wa_fronted_settings_form</strong> runs within the settings modal form element (passes complete JSON encoded options as argument)</li>
<li><strong>wa_fronted_settings_modal_footer</strong> runs when settings modal footer renders (the container where the update button is, still inside the settings form element) (passes complete options array as argument)</li>
<li><strong>wa_fronted_settings_form_save</strong> runs after the post has been updated with the new values but before user has been redirected to the new permalink</li>
</ul>
<h3 id="javascript">Javascript</h3>
<blockquote>
<p>The javascript action hooks functions very similarly to their native PHP counterparts. Only difference is that these functions resides within the <code>wa_fronted</code> object, so to call the <code>add_action</code> function, you type like so: <code>wa_fronted.add_action(&#39;action_name&#39;, function);</code></p>
</blockquote>
<ul>
<li><strong>on_init</strong> runs within the wa_fronted.initialize function</li>
<li><strong>on_bind</strong> runs within the wa_fronted.bind function</li>
<li><strong>on_setup_editor</strong> if the option <code>native</code> is false, this action will run instead of the regular editor setup, passes 3 arguments, jQuery object of editor container, current editor options and full options object</li>
</ul>
<p><em>I&#39;ll try to add hooks where I see it could be useful, but if you are missing one, please post an issue requesting it</em></p>
<h2 id="filters">Filters</h2>
<h3 id="php">PHP</h3>
<ul>
<li><strong>compile_options</strong> modify the partially compiled options array (3 arguments, $compiled_options, $default_options, $new_options, called multiple times)</li>
<li><strong>wa_fronted_options</strong> modify options array, use this to set your options (1 argument)</li>
<li><strong>wa_fronted_settings_fields</strong> modify default settings fields to render into form (1 argument, array of field keys)</li>
<li><strong>wa_fronted_settings_values</strong> modify values before they&#39;re sent to the <code>wp_update_post</code> function array, use this to set your options (1 argument)</li>
<li><strong>supported_acf_fields</strong> modify supported ACF fields array (1 argument)</li>
<li><strong>supported_woo_fields</strong> modify supported WooCommerce fields/values array (1 argument)</li>
<li><strong>supported_custom_fields</strong> modify supported native custom field types (1 argument)</li>
</ul>
<h3 id="javascript">Javascript</h3>
<blockquote>
<p>The javascript filters functions very similarly to their native PHP counterparts. Only difference is that these functions resides within the <code>wa_fronted</code> object, so to call the <code>add_filter</code> function, you type like so: <code>wa_fronted.add_filter(&#39;filter_name&#39;, function(value){ return value; });</code></p>
</blockquote>
<ul>
<li><strong>toolbar_buttons</strong> modify the buttons available to the editor toolbar (2 arguments), passes an array of strings as the first argument <em>(which should be returned)</em> and current editor options as second</li>
<li><strong>medium_extensions</strong> modify extensions of the Medium Editor (2 arguments), passes an object with active extensions as the first argument <em>(which should be returned)</em>, and current editor options as second. Want to make a toolbar extension? <a href="https://github.com/yabwe/medium-editor/tree/master/src/js/extensions">Look here</a></li>
<li><strong>validate</strong> add a custom validation method. Should only return true or false (4 arguments), <code>bool</code> (result), <code>value to validate</code>, <code>validation method called</code>, <code>comparison value</code></li>
<li><strong>validation_msg</strong> add a custom validation error message (3 arguments), <code>message</code>, <code>validation method</code>, <code>comparison value</code></li>
</ul>
<p><em>I&#39;ll try to add filters where I see it could be useful, but if you are missing one, please post an issue requesting it</em></p>
<h2 id="features">Features</h2>
<blockquote>
<p>Unchecked boxes are features that are planned to be implemented in the near future (in no particular order)</p>
</blockquote>
<ul>
<li>[x] Automatic changing of image size to load when changing size of image in content</li>
<li>[x] Gallery shortcode editing</li>
<li>[x] Advanced Custom Fields support (see supported ACF fields for more details)</li>
<li>[x] Automatic oEmbed conversion upon paste</li>
<li>[x] Automatic url to link conversion</li>
<li>[x] Automatic updates</li>
<li>[x] Ability to edit featured image</li>
<li>[x] Show unsaved changes warning if leaving page</li>
<li>[x] Ability to edit other columns from the posts table (<code>post_name</code>, <code>post_date</code> and <code>post_status</code>)</li>
<li>[x] Extend pluggability further and support for extensions (enable to hook onto and modify js editor)</li>
<li>[x] Ability to set post as featured</li>
<li>[x] Allow/Disable comments</li>
<li>[x] WooCommerce support for simple product types (see supported WooCommerce fields for more details)</li>
<li>[x] Live value validation</li>
<li>[x] Image upload by dropping an image into the editable area</li>
<li>[x] Basic RTL support</li>
<li>[x] Native custom fields support</li>
<li>[x] Choice-based fields with dropdown-select (hover on content to show dropdown and select option to insert)</li>
<li>[x] Multiple <code>output_to</code> selectors and attrs</li>
<li>[x] Shortcodes support (other than gallery)</li>
<li>[x] Ability to edit fields saved in the wp_options table</li>
<li>[x] Ability to set default options in posttype level of array</li>
<li>[ ] Post revisions</li>
<li>[ ] Edit taxonomies (and native tags and categories)</li>
<li>[ ] Drag image to move it within the editable area</li>
<li>[ ] Smarter outputting of value (like if it&#39;s an image field and has no output options, determine by itself)</li>
<li>[ ] Validate on server-side before save</li>
<li>[ ] Move documentation to Wiki</li>
<li>[ ] How-to guide for integration and extensions</li>
<li>[ ] Translations</li>
</ul>
<h2 id="proposed-features">Proposed features</h2>
<blockquote>
<p>These features requires further discussion, not yet set to be implemented</p>
</blockquote>
<ul>
<li>[ ] Autosave</li>
<li>[ ] Enhance UX by visualizing which area you are editing</li>
<li>[ ] Make it possible to create new posts from frontend</li>
<li>[ ] Change common ajax functions to make use of WP Rest API instead (when implemented into core)</li>
<li>[ ] Spellchecking and word suggestion, auto correction</li>
<li>[ ] Ability to update widget contents</li>
<li>[ ] Editing from archives/blog home</li>
<li>[ ] Markdown parser</li>
<li>[ ] Column-maker (made as an add-on?)</li>
<li>[ ] Extended WooCommerce support</li>
<li>[ ] More ACF fields support</li>
<li>[ ] Mirror style of current WP admin theme</li>
<li>[ ] Optimization for small screens</li>
<li>[ ] Live SEO analyzis and tips, Yoast integration add-on?</li>
</ul>
<h3 id="supported-custom-field-types">Supported custom field types</h3>
<ul>
<li>Text <code>meta_text</code></li>
<li>Text Area <code>meta_textarea</code></li>
<li>Number <code>meta_number</code></li>
<li>Email <code>meta_email</code></li>
<li>Url <code>meta_url</code></li>
<li>Wysiwyg Editor <code>meta_wysiwyg</code></li>
<li>Image <code>meta_image</code></li>
<li>Select (dropdown) <code>meta_select</code></li>
</ul>
<h3 id="supported-acf-field-types">Supported ACF field types</h3>
<ul>
<li>Text</li>
<li>Text Area</li>
<li>Number</li>
<li>Email</li>
<li>Url</li>
<li>Password</li>
<li>Wysiwyg Editor</li>
<li>oEmbed</li>
<li>Image</li>
<li>File</li>
<li>Select</li>
<li>Radio</li>
</ul>
<h3 id="supported-woocommerce-fields-for-simple-product-types-">Supported WooCommerce fields (for simple product types)</h3>
<ul>
<li>SKU <code>woo_sku</code></li>
<li>Price <code>woo_price</code></li>
<li>Sale Price <code>woo_sale_price</code><ul>
<li>Scheduling</li>
</ul>
</li>
<li>Short Description <code>woo_short_description</code></li>
<li>Inventory (through settings modal)<ul>
<li>Stock Quantitiy (if manage stock is enabled)</li>
<li>Stock Status</li>
</ul>
</li>
<li>Catalog visibility (through settings modal)</li>
<li>Featured product (through settings modal)</li>
</ul>
<h2 id="extending">Extending</h2>
<p>There will be a proper how-to guide here, but for now, you can look in the <code>extensions</code> folder for examples on how to create an extension</p>
<h2 id="collaboration-notes">Collaboration notes</h2>
<ul>
<li>I&#39;m using Sass for styling and <a href="https://prepros.io/">PrePros</a> for compiling (there&#39;s a free version if you wanna check it out)</li>
<li>JS files are minified and concatenated with <a href="https://prepros.io/">PrePros</a>, so without it you&#39;ll have to load the other js files individually (see prepros-prepend comments in the beginning of scripts.js)</li>
<li>I&#39;m using <a href="http://bower.io/">Bower</a> for keeping the following libraries up to date:<ul>
<li><a href="https://github.com/yabwe/medium-editor">Medium Editor</a></li>
<li><a href="https://github.com/trentrichardson/jQuery-Timepicker-Addon">jQuery Timepicker Addon</a></li>
<li><a href="https://github.com/object505/tipso">tipso</a></li>
<li><a href="https://github.com/CodeSeven/toastr">toastr</a></li>
</ul>
</li>
<li>Core features should be free and open source</li>
<li>Comment your code</li>
</ul>
<h2 id="license">License</h2>
<p>See the <a href="LICENSE.md">LICENSE</a> file for license rights (GPLv2)</p>
